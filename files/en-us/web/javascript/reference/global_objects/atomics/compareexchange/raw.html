<div>{{JSRef}}</div>

<p>The static <code><strong>Atomics</strong></code><strong><code>.compareExchange()</code></strong> method exchanges a given replacement value at a given position in the array, if a given expected value equals the old value.Â  It returns the old value at that position whether it was equal to the expected value or not. This atomic operation guarantees that no other write happens until the modified value is written back.</p>

<div>{{EmbedInteractiveExample("pages/js/atomics-compareexchange.html")}}</div>

<p class="hidden">The source for this interactive example is stored in a GitHub repository. If you'd like to contribute to the interactive examples project, please clone <a href="https://github.com/mdn/interactive-examples">https://github.com/mdn/interactive-examples</a> and send us a pull request.</p>

<h2 id="Syntax">Syntax</h2>

<pre class="syntaxbox">Atomics.compareExchange(typedArray, index, expectedValue, replacementValue)
</pre>

<h3 id="Parameters">Parameters</h3>

<dl>
 <dt><code>typedArray</code></dt>
 <dd>A shared integer typed array. One of {{jsxref("Int8Array")}}, {{jsxref("Uint8Array")}}, {{jsxref("Int16Array")}}, {{jsxref("Uint16Array")}}, {{jsxref("Int32Array")}}, or {{jsxref("Uint32Array")}}.</dd>
 <dt><code>index</code></dt>
 <dd>The position in the <code>typedArray</code> to exchange a <code>value</code>.</dd>
 <dt><code>expectedValue</code></dt>
 <dd>The value to check for equality.</dd>
 <dt>replacementValue</dt>
 <dd>The number to exchange.</dd>
</dl>

<h3 id="Return_value">Return value</h3>

<p>The old value at the given position (<code>typedArray[index]</code>).</p>

<h3 id="Exceptions">Exceptions</h3>

<ul>
 <li>Throws a {{jsxref("TypeError")}}, if <code>typedArray</code> is not one of the allowed integer types.</li>
 <li>Throws a {{jsxref("TypeError")}}, if <code>typedArray</code> is not a shared typed array type.</li>
 <li>Throws a {{jsxref("RangeError")}}, if <code>index</code> is out of bounds in the <code>typedArray</code>.</li>
</ul>

<h2 id="Examples">Examples</h2>

<pre class="brush: js">const sab = new SharedArrayBuffer(1024);
const ta = new Uint8Array(sab);
ta[0] = 7;

Atomics.compareExchange(ta, 0, 7, 12); // returns 7, the old value
Atomics.load(ta, 0); // 12</pre>

<h2 id="Specifications">Specifications</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <th scope="col">Specification</th>
   <th scope="col">Status</th>
   <th scope="col">Comment</th>
  </tr>
  <tr>
   <td>{{SpecName('ESDraft', '#sec-atomics.compareexchange', 'Atomics.compareExchange')}}</td>
   <td>{{Spec2('ESDraft')}}</td>
   <td>Initial definition in ES2017.</td>
  </tr>
 </tbody>
</table>

<h2 id="Browser_compatibility">Browser compatibility</h2>

<div class="hidden">The compatibility table on this page is generated from structured data. If you'd like to contribute to the data, please check out <a href="https://github.com/mdn/browser-compat-data">https://github.com/mdn/browser-compat-data</a> and send us a pull request.</div>

<p>{{Compat("javascript.builtins.Atomics.compareExchange")}}</p>

<h2 id="See_also">See also</h2>

<ul>
 <li>{{jsxref("Atomics")}}</li>
 <li>{{jsxref("Atomics.exchange()")}}</li>
</ul>