<div>{{FirefoxSidebar}}</div><h3 id="Introduzione" name="Introduzione">Introduzione</h3>

<p><a href="/it/Firefox_1.5" title="it/Firefox_1.5">Firefox 1.5</a> usa un soistema di caching in memoria per pagine Web intere, includendone lo stato JavaScript, per una singola sessione del browser. Muoversi in avanti ed indietro tra le pagine visitate non richiede alcun caricamento e lo stato di JavaScript viene preservato. Questa caratteristica, a cui ci si riferisce a volte come <strong>bfcache</strong> (per "Back-Forward Cache"), rende la navigazione delle pagine molto veloc. Tale stato di caching viene preservato fino a quando non viene chiuso il browser.</p>

<p>Esistono delle istanze in cui Firefox non memorizza pagine in cache. Ecco alcune ragioni programmatiche per cui viene seguito questo comportamento:</p>

<ul>
 <li>la pagina usa un gestore <code>unload</code></li>
 <li>la pagina imposta "cache-control: no-store"</li>
 <li>la pagina imposta "cache-control: no-cache" ed il sito è in HTTPS.</li>
 <li>la pagina non è completamente caricata mentre l'utente decide di vistarne un'altra</li>
 <li>la pagina di più alto livello contiene dei frame che non sono memorizzabli in cache</li>
 <li>la pagina si trova in un frame in cui l'utente carica una nuova pagina (in questo caso, quando l'utente termina termina la navigazione della pagina, l'ultimo contenuto della pagina sarà quello memorizzato in cache)</li>
</ul>

<p>Questa nuova caratteristiac del caching modifica il comportamento del caricamento di pagine, e gli autori web vorrebbero poter:</p>

<ul>
 <li>sapere che una pagina è stata esplorata (quando viene caricata dalla cache di un utente)</li>
 <li>definire il comportamento di una pagina quando l'utente termina la navigazione uscendone (mantenendo la possibilità del caching della pagina)</li>
</ul>

<p>Due nuovi eventi del browser permettono entrambe le operazioni.</p>

<h3 id="Nuovi_eventi_del_browser" name="Nuovi_eventi_del_browser">Nuovi eventi del browser</h3>

<p><span class="comment">If you use these new events, your pages will continue to display properly in other browsers (we’ve tested earlier versions of Firefox, Internet Explorer, Opera, and Safari), and will use this new caching functionality when loaded in Firefox 1.5. Standard behavior for Web pages is: # User navigates to a page. # As the page loads, inline scripts run. # Once the page is loaded, the &lt;code&gt;onload&lt;/code&gt; handler fires. Some pages include a fourth step. If a page uses an &lt;code&gt;unload&lt;/code&gt; handler, it fires when the user navigates away from the page. If an &lt;code&gt;unload&lt;/code&gt; handler is present, the page will not be cached. When a user navigates to a cached page, inline scripts and the &lt;code&gt;onload&lt;/code&gt; handler do not run (steps 2 and 3), since in most cases, the effects of these scripts have been preserved. If the page contains scripts or other behaviors that fire during loading that you want to continue to execute every time the user navigates to the page, or if you want to know when a user has navigated to a cached page, use the new &lt;code&gt;pageshow&lt;/code&gt; event. If you have behaviors that fire when a user navigates away from the page, but you want to take advantage of this new caching feature, and therefore don’t want to use the unload handler, use the new &lt;code&gt;pagehide&lt;/code&gt; event.</span></p>

<h4 id="Evento_pageshow" name="Evento_pageshow">Evento pageshow</h4>

<p><span class="comment">This event works the same as the &lt;code&gt;load&lt;/code&gt; event, except that it fires every time the page is loaded (whereas the &lt;code&gt;load&lt;/code&gt; event doesn’t fire in Firefox 1.5 when the page is loaded from cache). The first time the page loads, the &lt;code&gt;pageshow&lt;/code&gt; event fires just after the firing of the &lt;code&gt;load&lt;/code&gt; event. The &lt;code&gt;pageshow&lt;/code&gt; event uses a boolean property called &lt;code&gt;persisted&lt;/code&gt; that is set to &lt;code&gt;false&lt;/code&gt; on the initial load. It is set to &lt;code&gt;true&lt;/code&gt; if it is not the initial load (in other words, it is set to true when the page is cached). Set any JavaScript that you want to run every time a page loads to run when the &lt;code&gt;pageshow&lt;/code&gt; event fires. If you call JavaScript functions as part of the &lt;code&gt;pageshow&lt;/code&gt; event, you can ensure these functions are called when the page is loaded in browsers other than Firefox 1.5 by calling the &lt;code&gt;pageshow&lt;/code&gt; event as part of the &lt;code&gt;load&lt;/code&gt; event, as shown in the sample later in this article.</span></p>

<h4 id="Evento_pagehide" name="Evento_pagehide">Evento pagehide</h4>

<p><span class="comment">If you want to define behavior that occurs the user navigates away from the page, but you don’t want to use the &lt;code&gt;unload&lt;/code&gt; event (which would cause the page to not be cached), you can use the new &lt;code&gt;pagehide&lt;/code&gt; event. Like &lt;code&gt;pageshow&lt;/code&gt;, the &lt;code&gt;pagehide&lt;/code&gt; event uses a boolean property called &lt;code&gt;persisted&lt;/code&gt;. This property is set to &lt;code&gt;false&lt;/code&gt; if the page is not cached by the browser and set to &lt;code&gt;true&lt;/code&gt; if the page is cached by the browser. When this property is set to &lt;code&gt;false&lt;/code&gt;, the &lt;code&gt;unload&lt;/code&gt; handler, if present, fires immediately after the &lt;code&gt;pagehide&lt;/code&gt; event. Firefox 1.5 tries to simulate load events in the same order they would occur when the page is initially loaded. Frames are treated the same way as the top-level document. If the page contains frames, then when the cached page is loaded: * &lt;code&gt;pageshow&lt;/code&gt; events from each frame fire before the &lt;code&gt;pageshow&lt;/code&gt; event in the main document fires. * When the user navigates away from the cached page, the &lt;code&gt;pagehide&lt;/code&gt; event from each frame fires before the &lt;code&gt;pagehide&lt;/code&gt; event in the main document. * For navigation that occurs inside a single frame, events fire only in the affected frame.</span></p>

<h3 id="Esempio_di_codice" name="Esempio_di_codice">Esempio di codice</h3>

<p><span class="comment">The sample below illustrates a page that uses both the &lt;code&gt;load&lt;/code&gt; and &lt;code&gt;pageshow&lt;/code&gt; events. This sample page behaves as follows: * In browsers other than Firefox 1.5, the following occurs each time the page loads: the &lt;code&gt;load&lt;/code&gt; event triggers the &lt;code&gt;onLoad&lt;/code&gt; function, which calls the &lt;code&gt;onPageShow&lt;/code&gt; function (as well as an additional function). * In Firefox 1.5, the first time the page is loaded, the &lt;code&gt;load&lt;/code&gt; event operates the same way as in other browsers. In addition, the &lt;code&gt;pageshow&lt;/code&gt; event fires, and as &lt;code&gt;persisted&lt;/code&gt; is set to &lt;code&gt;false&lt;/code&gt;, no additional action occurs. * In Firefox 1.5, when the page is loaded from cache, only the &lt;code&gt;pageshow&lt;/code&gt; event fires. As &lt;code&gt;persisted&lt;/code&gt; is set to &lt;code&gt;true&lt;/code&gt;, only the JavaScript actions in the &lt;code&gt;onPageShow&lt;/code&gt; function are triggered. In this example: * The page calculates and displays the current date and time each time the page is loaded. This calculation includes the seconds and milliseconds so you can easily test the functionality. * The cursor is placed in the Name field of the form the first time the page is loaded. In Firefox 1.5, when the user navigates back to the page, the cursor remains in the field it was when the user navigated away from the page. In other browsers, the cursor moves back to the Name field. &lt;pre&gt; &lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "<a class="external" href="http://www.w3.org/TR/html4/loose.dtd" rel="freelink">http://www.w3.org/TR/html4/loose.dtd</a>"&gt; &lt;HTML&gt; &lt;head&gt; &lt;title&gt;Order query : Firefox 1.5 Example&lt;/title&gt; &lt;style type="text/css"&gt; body, p { font-family: Verdana, sans-serif; font-size: 12px; } &lt;/style&gt; &lt;script type="text/javascript"&gt; function onLoad() { loadOnlyFirst(); onPageShow(); } function onPageShow() { //calculate current time var currentTime= new Date(); var year=currentTime.getFullYear(); var month=currentTime.getMonth()+1; var day=currentTime.getDate(); var hour=currentTime.getHours(); var min=currentTime.getMinutes(); var sec=currentTime.getSeconds(); var mil=currentTime.getMilliseconds(); var displayTime = (month + "/" + day + "/" + year + " " + hour + ":" + min + ":" + sec + ":" + mil); document.getElementById("timefield").value=displayTime; } function loadOnlyFirst() { document.zipForm.name.focus(); } &lt;/script&gt; &lt;/head&gt; &lt;body onload="onLoad();" onpageshow="if (event.persisted) onPageShow();"&gt; &lt;h2&gt;Order query&lt;/h2&gt; &lt;form name="zipForm" action="<a class="external" href="http://www.example.com/formresult.html" rel="freelink">http://www.example.com/formresult.html</a>" method="get"&gt; &lt;label for="timefield"&gt;Date and time:&lt;/label&gt; &lt;input type="text" id="timefield"&gt;&lt;br&gt; &lt;label for="name"&gt;Name:&lt;/label&gt; &lt;input type="text" id="name"&gt;&lt;br&gt; &lt;label for="address"&gt;Email address:&lt;/label&gt; &lt;input type="text" id="address"&gt;&lt;br&gt; &lt;label for="order"&gt;Order number:&lt;/label&gt; &lt;input type="text" id="order"&gt;&lt;br&gt; &lt;input type="submit" name="submit" value="Submit Query"&gt; &lt;/form&gt; &lt;/body&gt; &lt;/html&gt; &lt;/pre&gt; In contrast, if the above page did not listen for the &lt;code&gt;pageshow&lt;/code&gt; event and handled all calculations as part of the &lt;code&gt;load&lt;/code&gt; event (and instead was coded as shown in the sample code fragment below), both the cursor position and date/time would be cached in Firefox 1.5 when the user navigated away from the page. When the user returned to the page, the cached date/time would display. &lt;pre&gt; &lt;script&gt; function onLoad() { loadOnlyFirst(); //calculate current time var currentTime= new Date(); var year = currentTime.getFullYear(); var month = currentTime.getMonth()+1; var day = currentTime.getDate(); var hour=currentTime.getHours(); var min=currentTime.getMinutes(); var sec=currentTime.getSeconds(); var mil=currentTime.getMilliseconds(); var displayTime = (month + "/" + day + "/" + year + " " + hour + ":" + min + ":" + sec + ":" + mil); document.getElementById("timefield").value=displayTime; } function loadOnlyFirst() { document.zipForm.name.focus(); } &lt;/script&gt; &lt;/head&gt; &lt;body onload="onLoad();"&gt; &lt;/pre&gt;</span></p>

<h3 id="Sviluppare_estensioni_per_Firefox" name="Sviluppare_estensioni_per_Firefox">Sviluppare estensioni per Firefox</h3>

<p><span class="comment">Firefox 1.5 <a href="/it/Building_an_Extension">extensions</a> need to allow for this caching functionality. If you are developing a Firefox extension that you want to be compatible with both 1.5 and earlier versions, make sure that it listens for the &lt;code&gt;load&lt;/code&gt; event for triggers that can be cached and listens for the &lt;code&gt;pageshow&lt;/code&gt; event for triggers that shouldn’t be cached. For instance, the Google Toolbar for Firefox should listen for the &lt;code&gt;load&lt;/code&gt; event for the autolink function and to the &lt;code&gt;pageshow&lt;/code&gt; event for the PageRank function in order to be compatible with both 1.5 and earlier versions.</span></p>