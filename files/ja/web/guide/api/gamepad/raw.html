<p> </p>

<div class="summary">
<p><span class="seoSummary">HTML5 はリッチでインタラクティブなゲームを開発するために必要なコンポーネントを多く搭載しています。 <code>&lt;canvas&gt;</code> や WebGL、<code>&lt;audio&gt;</code> に <code>&lt;video&gt; </code>などの技術は、今まで Native コードを書く必要のあった機能をサポートできるほどに成長しました。Gamepad API は開発者とデザイナーに Gamepad やコントローラーへのアクセスを提供するものです。</span></p>
</div>

<p><a href="https://developer.mozilla.org/docs/Web/API/Gamepad_API">Gamepad API</a> は {{ domxref("Window") }} オブジェクトにGamepadとコントローラー（以下、Gamepad）の状態を読み取る新しいイベントをいくつか追加します。さらに、 {{ domxref("Gamepad") }} というGamepadの接続状態が得られるオブジェクトと {{ domxref("navigator.getGamepads") }} というGamepadの一覧を取得できるメソッドが追加されます。 </p>

<h2 id="conntecting" name="conntecting">Gamepad の接続</h2>

<p>新しい Gamepad が接続された時、アクティブなページは {{ event("gamepadconnected") }} イベントを受け取ります。ページ読み込み時にGamepadがすでに接続されている場合、Gamepad のボタンを押すなどの操作をした時に {{ event("gamepadconnected") }} イベントがアクティブなページに対して発生します。</p>

<div class="blockIndicator geckoVersionNote">
<p>Firefox では、 ページが見える状態でかつユーザーによる Gamepad の操作を受け付けたときにのみ、Gamepad が利用可能になります。これによって、ユーザーを特定する Fingerprinting に利用されることを防止しています。一度一つのコントローラーが操作されれば、他のコントローラーも自動で接続され利用可能になります。</p>
</div>

<p>以下のようにして {{ event("gamepadconnected") }} を使用します:</p>

<pre class="brush: js;">window.addEventListener("gamepadconnected", function(e) {
  console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",
    e.gamepad.index, e.gamepad.id,
    e.gamepad.buttons.length, e.gamepad.axes.length);
});
</pre>

<p>Gamepad はそれぞれ固有の ID を <code>gamepad</code> プロパティの中に持っています。</p>

<h2 id="disconnecting" name="disconnecting">Gamepad の切断</h2>

<p>Gamepad が切断されると、Gamepad が以前に受信したデータ(例: {{ event("gamepadconnected") }} )があると、2番目のイベント(例: {{ event("gamepadconnected") }} )がフォーカスされたウィンドウにディスパッチします:</p>

<pre class="brush: js line-numbers  language-js"><code class="language-js">window<span class="punctuation token">.</span><span class="function token">addEventListener</span><span class="punctuation token">(</span><span class="string token">"gamepaddisconnected"</span><span class="punctuation token">,</span> <span class="keyword token">function</span><span class="punctuation token">(</span>e<span class="punctuation token">)</span> <span class="punctuation token">{</span>
  console<span class="punctuation token">.</span><span class="function token">log</span><span class="punctuation token">(</span><span class="string token">"Gamepad disconnected from index %d: %s"</span><span class="punctuation token">,</span>
    e<span class="punctuation token">.</span>gamepad<span class="punctuation token">.</span>index<span class="punctuation token">,</span> e<span class="punctuation token">.</span>gamepad<span class="punctuation token">.</span>id<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span><span class="punctuation token">)</span><span class="punctuation token">;</span></code></pre>

<p>Gamepadの {{domxref("Gamepad.index", "index")}} というプロパティは同じタイプの複数のコントローラーが使用されている場合であっても、システムに接続されたデバイスごとにユニークになります。 <code>Index</code> プロパティもまた {{ domxref("Navigator.getGamepads()") }} として戻される {{jsxref("Array")}} の index として機能します。</p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">var</span> gamepads <span class="operator token">=</span> <span class="punctuation token">{</span><span class="punctuation token">}</span><span class="punctuation token">;</span>

<span class="keyword token">function</span> <span class="function token">gamepadHandler</span><span class="punctuation token">(</span>event<span class="punctuation token">,</span> connecting<span class="punctuation token">)</span> <span class="punctuation token">{</span>
  <span class="keyword token">var</span> gamepad <span class="operator token">=</span> event<span class="punctuation token">.</span>gamepad<span class="punctuation token">;</span>
  <span class="comment token">// Note:</span>
  <span class="comment token">// gamepad === navigator.getGamepads()[gamepad.index]</span>

  <span class="keyword token">if</span> <span class="punctuation token">(</span>connecting<span class="punctuation token">)</span> <span class="punctuation token">{</span>
    gamepads<span class="punctuation token">[</span>gamepad<span class="punctuation token">.</span>index<span class="punctuation token">]</span> <span class="operator token">=</span> gamepad<span class="punctuation token">;</span>
  <span class="punctuation token">}</span> <span class="keyword token">else</span> <span class="punctuation token">{</span>
    <span class="keyword token">delete</span> gamepads<span class="punctuation token">[</span>gamepad<span class="punctuation token">.</span>index<span class="punctuation token">]</span><span class="punctuation token">;</span>
  <span class="punctuation token">}</span>
<span class="punctuation token">}</span>

window<span class="punctuation token">.</span><span class="function token">addEventListener</span><span class="punctuation token">(</span><span class="string token">"gamepadconnected"</span><span class="punctuation token">,</span> <span class="keyword token">function</span><span class="punctuation token">(</span>e<span class="punctuation token">)</span> <span class="punctuation token">{</span> <span class="function token">gamepadHandler</span><span class="punctuation token">(</span>e<span class="punctuation token">,</span> <span class="keyword token">true</span><span class="punctuation token">)</span><span class="punctuation token">;</span> <span class="punctuation token">}</span><span class="punctuation token">,</span> <span class="keyword token">false</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
window<span class="punctuation token">.</span><span class="function token">addEventListener</span><span class="punctuation token">(</span><span class="string token">"gamepaddisconnected"</span><span class="punctuation token">,</span> <span class="keyword token">function</span><span class="punctuation token">(</span>e<span class="punctuation token">)</span> <span class="punctuation token">{</span> <span class="function token">gamepadHandler</span><span class="punctuation token">(</span>e<span class="punctuation token">,</span> <span class="keyword token">false</span><span class="punctuation token">)</span><span class="punctuation token">;</span> <span class="punctuation token">}</span><span class="punctuation token">,</span> <span class="keyword token">false</span><span class="punctuation token">)</span><span class="punctuation token">;</span></code></pre>

<p>この前の例ではイベントが完了した後に <code>gamepad</code> プロパティがどのように保持できるかを示しています - <span lang="ja">後でデバイスの状態照会のために使用する技術となります。</span></p>

<h2 id="querying" name="querying">Gamepad オブジェクトの問い合わせ</h2>

<p>ご覧のように、上述の <strong>Gamepad</strong> イベントは<span lang="ja"> </span> {{ domxref("Gamepad") }} <span lang="ja"> オブジェクトを返すイベントオブジェクト、上の </span> <code>gamepad</code> <span lang="ja"> のプロパティが含まれています。</span>複数の Gamepad (すなわち、そのID ) を一度に接続される可能性があるため、イベントを発生させたのはどのゲームパッドを決定するためにこれらを使用することができます。それへの参照を保持し、それがボタンや軸のいずれかの時点で押されているかを知るために照会するなど、{{ domxref("Gamepad") }} オブジェクトから様々なことを行うことができます。そうすることで、多くの場合、今回と次回のイベント発生とゲームパッドの状態を知っておく必要があり、ゲームやその他のインタラクティブな Web ページであることが望ましいです。</p>

<p><span id="result_box" lang="ja"><span>このようなチェック</span><span>を実行すると</span><span>、開発者は</span><span>ゲームパッド</span><span>や</span><span>ゲームパッド</span><span>の状態に基づいて、</span><span>現在のフレーム</span><span>のための</span><span>意思決定を行うために</span><span>必要な</span><span>アニメーションループ</span><span> (</span><span>例 : </span></span>{{ domxref("Window.requestAnimationFrame","requestAnimationFrame") }}<span lang="ja"><span>) </span><span>と</span><span>一緒に </span></span>{{ domxref("Gamepad") }} <span lang="ja"><span>オブジェクト</span><span>を</span><span>使用して</span><span>関与</span><span>する傾向があります</span><span>。</span></span></p>

<div>
<p>{{ domxref("Navigator.getGamepads()") }} メソッドは現在 Web ページから見える {{ domxref("Gamepad") }} オブジェクト ( Gamepad が繋がっていない時は毎回 null が返される ) のような、すべてのデバイスを配列として戻します。<span class="short_text" id="result_box" lang="ja"><span>これは</span><span>、同じ</span><span>情報を得る</span><span>ために使用することができます</span><span>。</span></span>例えば、 <span class="short_text" id="result_box" lang="ja"><span>以下に示すように</span><span>上記の</span><span>最初のコード例</span><span>を</span><span>書き換えます</span><span>：</span></span></p>
</div>

<pre class="brush: js line-numbers  language-js"><code class="language-js">window<span class="punctuation token">.</span><span class="function token">addEventListener</span><span class="punctuation token">(</span><span class="string token">"gamepadconnected"</span><span class="punctuation token">,</span> <span class="keyword token">function</span><span class="punctuation token">(</span>e<span class="punctuation token">)</span> <span class="punctuation token">{</span>
  <span class="keyword token">var</span> gp <span class="operator token">=</span> navigator<span class="punctuation token">.</span><span class="function token">getGamepads</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">[</span>e<span class="punctuation token">.</span>gamepad<span class="punctuation token">.</span>index<span class="punctuation token">]</span><span class="punctuation token">;</span>
  console<span class="punctuation token">.</span><span class="function token">log</span><span class="punctuation token">(</span><span class="string token">"Gamepad connected at index %d: %s. %d buttons, %d axes."</span><span class="punctuation token">,</span>
    gp<span class="punctuation token">.</span>index<span class="punctuation token">,</span> gp<span class="punctuation token">.</span>id<span class="punctuation token">,</span>
    gp<span class="punctuation token">.</span>buttons<span class="punctuation token">.</span>length<span class="punctuation token">,</span> gp<span class="punctuation token">.</span>axes<span class="punctuation token">.</span>length<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span><span class="punctuation token">)</span><span class="punctuation token">;</span></code></pre>

<p>{{ domxref("Gamepad") }} オブジェクトの機能は以下です :</p>

<ul>
 <li><code>id</code>: コントローラーに関する情報を含んだ文字列です。これは厳密には指定されていなく、Firefox では、コントローラのUSBベンダと製品IDを含んでいる2つの4桁16進数字列、およびドライバーから提供されるようなコントローラの名前といった3つの情報が、ダッシュ（-）により分離され含まれています。この情報はユーザーへの有益なフィードバックを表示するとともに、デバイスのコントロールのマッピングを見つけることができるようにします。</li>
 <li><code>index</code>: <span id="result_box" lang="ja"><span>現在システムに接続されているゲームパッドごとに固有の整数。</span><span>この値は複数のコントローラを区別するために使用できます。</span><span>デバイスを切断してから新しいデバイスを接続すると、以前のインデックスが再利用されることに注意してください。</span></span></li>
 <li><code>mapping</code>: <span id="result_box" lang="ja"><span>ブラウザがデバイス上のコントロールを既知のレイアウトに再マップしたかどうかを示す文字列。</span><span>現在、サポートされている既知のレイアウト - </span></span><a href="https://dvcs.w3.org/hg/gamepad/raw-file/default/gamepad.html#remapping">標準のゲームパッド</a><span lang="ja"><span>は1つしかありません。</span><span>ブラウザがデバイス上のコントロールをそのレイアウトにマッピングできる場合、<code>mapping</code>プロパティは文字列<code>standard</code>に設定されます。</span></span></li>
 <li><code>connected</code>: <span id="result_box" lang="ja"><span>ゲームパッドがシステムに接続されているかどうかを示すブール値。</span>もし接続されている場合<span>は</span></span><code>True</code><span lang="ja"><span>。</span>接続されていない場合は</span><code>False</code><span lang="ja"><span>が設定されます。</span></span></li>
 <li><code>buttons</code>: <span id="result_box" lang="ja"><span>デバイス上に存在するボタンを表す</span></span>{{ domxref("GamepadButton") }}<span lang="ja"><span>オブジェクトの配列。</span><span>各</span></span>{{ domxref("GamepadButton") }}<span lang="ja"><span>には、</span></span><code>pressed</code><span lang="ja"><span> のプロパティ</span></span><span id="result_box" lang="ja"><span>と </span></span><code>value</code><span lang="ja"><span> のプロパティがあり9ます</span></span>:
  <ul>
   <li><code>pressed</code> <span id="result_box" lang="ja"><span>プロパティは、ボタンが現在押されている( true )か押されていない( false )かを示すブール値です。</span></span></li>
   <li><code>value</code> <span id="result_box" lang="ja"><span>プロパティは、現代の多くのゲームパッドのトリガなど、アナログボタンの表示を有効にするために使用される浮動小数点値です。</span><span>値は0.0..1.0の範囲に正規化され、0.0は押されていないボタンを表し、1.0は完全に押されたボタンを表します。</span></span></li>
  </ul>
 </li>
 <li><code>axes</code>: <span id="result_box" lang="ja"><span>デバイス上に軸があるコントロールを表す配列 (例：アナログサムスティック)。</span> <span>配列の各エントリは-1.0〜1.0の範囲の浮動小数点値で、最小値 (-1.0) から最大値 (1.0) までの軸の位置を表します。</span></span></li>
 <li><code>timestamp</code>: <span id="result_box" lang="ja"><span>このゲームパッドのデータが最後に更新された時刻を表す</span></span>{{ domxref("DOMHighResTimeStamp") }}<span lang="ja"><span>を返します。この値により、開発者は </span></span><code>axes</code><span lang="ja"><span> と </span></span><code>button</code><span lang="ja"><span> のデータがハードウェアから更新されたかどうかを判断できます。</span> <span>値は、</span></span>{{ domxref("PerformanceTiming") }}<span lang="ja"><span>インターフェースの </span></span><code>navigationStart</code><span lang="ja"><span> 属性との相対値でなければなりません。</span> <span>値は単調に増加します。つまり、更新の順序を決定するために比較することができます。新しい値は常に古い値よりも大きいか等しいためです。</span><span>このプロパティは現在 Firefox ではサポートされていません。</span></span></li>
</ul>

<div class="note">
<p><strong>注記</strong>: <span id="result_box" lang="ja"><span>Gamepadオブジェクトは、セキュリティ上の理由から</span></span>{{ domxref("Window") }}<span lang="ja"><span>オブジェクトではなく</span></span>{{ event("gamepadconnected") }}<span lang="ja"><span>イベントで使用できます。</span><span>一度リファレンスを取得すると、そのプロパティでゲームパッドの現在の状態に関する情報を照会できます。</span> <span>このオブジェクトは、ゲームパッドの状態が変わるたびに更新されます。</span></span></p>
</div>

<h3 id="ボタン情報の使用">ボタン情報の使用</h3>

<p><span id="result_box" lang="ja"><span>1つのゲームパッドの接続情報を表示する簡単な例を見てみましょう (後続のゲームパッド接続を無視します)。ゲームパッドの右側にある4つのゲームパッドボタンを使用してボールを画面の周りに移動できます。</span></span><a href="http://chrisdavidmills.github.io/gamepad-buttons/">デモをライブで見ることができ</a><span lang="ja"><span>、Githubで</span></span><a href="https://github.com/chrisdavidmills/gamepad-buttons/tree/master">ソースコードを見つけることができます</a><span lang="ja"><span>。</span></span></p>

<p><span id="result_box" lang="ja"><span>まず、いくつかの変数を宣言します</span></span>: <span id="result_box" lang="ja"><span>接続情報が書き込まれる gamepadInfo のパラグラフ、移動する </span></span><code>ball</code><span lang="ja"><span>、</span></span><code>requestAnimation</code><span lang="ja"><span> </span></span><code>Frame</code><span lang="ja"><span> の ID として機能する </span></span><code>start</code><span lang="ja"><span> 変数、ボールを移動するための位置変更子として機能する </span></span><code>a</code><span lang="ja"><span> および </span></span><code>b</code><span lang="ja"><span> 変数、および短縮形変数</span> <span>これは、</span></span>{{ domxref("Window.requestAnimationFrame", "requestAnimationFrame()") }} and {{ domxref("Window.cancelAnimationFrame", "cancelAnimationFrame()") }}<span lang="ja"><span>および</span></span>{{ domxref("Window.cancelAnimationFrame", "cancelAnimationFrame()") }}<span lang="ja"><span>クロスブラウザフォークで使用されます。</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">var</span> gamepadInfo <span class="operator token">=</span> document<span class="punctuation token">.</span><span class="function token">getElementById</span><span class="punctuation token">(</span><span class="string token">"gamepad-info"</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="keyword token">var</span> ball <span class="operator token">=</span> document<span class="punctuation token">.</span><span class="function token">getElementById</span><span class="punctuation token">(</span><span class="string token">"ball"</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="keyword token">var</span> start<span class="punctuation token">;</span>
<span class="keyword token">var</span> a <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">;</span>
<span class="keyword token">var</span> b <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">;</span></code></pre>

<p><span id="result_box" lang="ja"><span>次に</span></span>{{ event("gamepadconnected") }}<span lang="ja"><span>イベントを使用して、接続されているゲームパッドを確認します。</span><span>接続されると</span></span>{{ domxref("Navigator.getGamepads()") }}<code>[0]</code><span lang="ja"><span>を使用してゲームパッドを取得し、ゲームパッドに関する情報をゲームパッドの情報 </span></span><code>div</code><span lang="ja"><span> に出力し、全体のボールの動きが始まる </span></span><code>gameLoop()</code><span lang="ja"><span> 関数が呼び出します</span><span>。</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js">window<span class="punctuation token">.</span><span class="function token">addEventListener</span><span class="punctuation token">(</span><span class="string token">"gamepadconnected"</span><span class="punctuation token">,</span> <span class="keyword token">function</span><span class="punctuation token">(</span>e<span class="punctuation token">)</span> <span class="punctuation token">{</span>
  <span class="keyword token">var</span> gp <span class="operator token">=</span> navigator<span class="punctuation token">.</span><span class="function token">getGamepads</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">[</span>e<span class="punctuation token">.</span>gamepad<span class="punctuation token">.</span>index<span class="punctuation token">]</span><span class="punctuation token">;</span>
  gamepadInfo<span class="punctuation token">.</span>innerHTML <span class="operator token">=</span> <span class="string token">"Gamepad connected at index "</span> <span class="operator token">+</span> gp<span class="punctuation token">.</span>index <span class="operator token">+</span> <span class="string token">": "</span> <span class="operator token">+</span> gp<span class="punctuation token">.</span>id <span class="operator token">+</span> <span class="string token">". It has "</span> <span class="operator token">+</span> gp<span class="punctuation token">.</span>buttons<span class="punctuation token">.</span>length <span class="operator token">+</span> <span class="string token">" buttons and "</span> <span class="operator token">+</span> gp<span class="punctuation token">.</span>axes<span class="punctuation token">.</span>length <span class="operator token">+</span> <span class="string token">" axes."</span><span class="punctuation token">;</span>

  <span class="function token">gameLoop</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span><span class="punctuation token">)</span><span class="punctuation token">;</span></code></pre>

<p><span id="result_box" lang="ja"><span>これで</span></span>{{ event("gamepaddisconnected") }}<span lang="ja"><span>イベントを使用して、ゲームパッドが再び切断されたかどうかを確認します。</span> <span>もしそうならば、</span></span>{{ domxref("Window.requestAnimationFrame", "requestAnimationFrame()") }}<span lang="ja"><span>ループ (下記参照) を停止し、ゲームパッドの情報を元の状態に戻します。</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js">window<span class="punctuation token">.</span><span class="function token">addEventListener</span><span class="punctuation token">(</span><span class="string token">"gamepaddisconnected"</span><span class="punctuation token">,</span> <span class="keyword token">function</span><span class="punctuation token">(</span>e<span class="punctuation token">)</span> <span class="punctuation token">{</span>
  gamepadInfo<span class="punctuation token">.</span>innerHTML <span class="operator token">=</span> <span class="string token">"Waiting for gamepad."</span><span class="punctuation token">;</span>

  <span class="function token">cancelRequestAnimationFrame</span><span class="punctuation token">(</span>start<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span><span class="punctuation token">)</span><span class="punctuation token">;</span></code></pre>

<p><span id="result_box" lang="ja"><span>Chromeでは異なる挙動になります。</span><span>変数にゲームパッドの最新の状態を常に保存するのではなく、スナップショットを保存するだけなので、Chrome で同じことを行うにはポーリングしてから</span></span>{{ domxref("Gamepad") }}<span lang="ja"><span>オブジェクトをコードで使用する必要があり、それは利用可能です。</span><span>私たちはこれを</span></span>{{ domxref("Window.setInterval()") }}<span lang="ja"><span>オブジェクトが利用可能になると、ゲームパッド情報が出力され、ゲームループが開始され、</span></span>{{ domxref("Window.clearInterval()") }}<span lang="ja"><span>を使用して間隔がクリアされます。</span> <span>Chrome </span></span>{{ domxref("Navigator.getGamepads()") }}<span lang="ja"><span>の古いバージョンでは、Webkit プレフィックスを使用して実装されています。</span><span>下位互換性のために、接頭辞付きのバージョンと関数の標準バージョンの両方を検出して処理しようとします。</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">var</span> interval<span class="punctuation token">;</span>

<span class="keyword token">if</span> <span class="punctuation token">(</span><span class="operator token">!</span><span class="punctuation token">(</span><span class="string token">'ongamepadconnected'</span> <span class="keyword token">in</span> window<span class="punctuation token">)</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
  <span class="comment token">// No gamepad events available, poll instead.</span>
  interval <span class="operator token">=</span> <span class="function token">setInterval</span><span class="punctuation token">(</span>pollGamepads<span class="punctuation token">,</span> <span class="number token">500</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>

<span class="keyword token">function</span> <span class="function token">pollGamepads</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
  <span class="keyword token">var</span> gamepads <span class="operator token">=</span> navigator<span class="punctuation token">.</span>getGamepads <span class="operator token">?</span> navigator<span class="punctuation token">.</span><span class="function token">getGamepads</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">:</span> <span class="punctuation token">(</span>navigator<span class="punctuation token">.</span>webkitGetGamepads <span class="operator token">?</span> navigator<span class="punctuation token">.</span>webkitGetGamepads <span class="punctuation token">:</span> <span class="punctuation token">[</span><span class="punctuation token">]</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
  <span class="keyword token">for</span> <span class="punctuation token">(</span><span class="keyword token">var</span> i <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">;</span> i <span class="operator token">&lt;</span> gamepads<span class="punctuation token">.</span>length<span class="punctuation token">;</span> i<span class="operator token">++</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">var</span> gp <span class="operator token">=</span> gamepads<span class="punctuation token">[</span>i<span class="punctuation token">]</span><span class="punctuation token">;</span>
    <span class="keyword token">if</span> <span class="punctuation token">(</span>gp<span class="punctuation token">)</span> <span class="punctuation token">{</span>
      gamepadInfo<span class="punctuation token">.</span>innerHTML <span class="operator token">=</span> <span class="string token">"Gamepad connected at index "</span> <span class="operator token">+</span> gp<span class="punctuation token">.</span>index <span class="operator token">+</span> <span class="string token">": "</span> <span class="operator token">+</span> gp<span class="punctuation token">.</span>id <span class="operator token">+</span>
        <span class="string token">". It has "</span> <span class="operator token">+</span> gp<span class="punctuation token">.</span>buttons<span class="punctuation token">.</span>length <span class="operator token">+</span> <span class="string token">" buttons and "</span> <span class="operator token">+</span> gp<span class="punctuation token">.</span>axes<span class="punctuation token">.</span>length <span class="operator token">+</span> <span class="string token">" axes."</span><span class="punctuation token">;</span>
      <span class="function token">gameLoop</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
      <span class="function token">clearInterval</span><span class="punctuation token">(</span>interval<span class="punctuation token">)</span><span class="punctuation token">;</span>
    <span class="punctuation token">}</span>
  <span class="punctuation token">}</span>
<span class="punctuation token">}</span></code></pre>

<p><span id="result_box" lang="ja"><span>今度はメインのゲームループです。</span><span>ループが実行されるたびに、4つのボタンの1つが押されているかどうかがチェックされます。</span>そうすると<span>、</span></span><code>a</code><span lang="ja"><span> と </span></span><code>b</code><span lang="ja"><span> の移動変数の値を適切に更新し、</span></span>{{ cssxref("left") }}<span lang="ja"><span>と</span></span>{{ cssxref("top") }}<span lang="ja"><span>のプロパティを更新し、その値を</span> </span><code>a</code><span lang="ja"> <span>および </span></span><code>b</code><span lang="ja"><span> とする。</span><span>これはボールを画面の周りに動かす効果があります。</span> <span>現在のバージョンの Chrome (この記事の執筆時点ではバージョン34) では、ボタンの値は</span></span>{{ domxref("GamepadButton") }}<span lang="ja"><span>オブジェクトではなく、double値の配列として保存されます。</span></span></p>

<p><span id="result_box" lang="ja"><span>この作業がすべて完了したら、</span></span><font face="Consolas, Monaco, Andale Mono, monospace">requestAnimationFrame()</font><span lang="ja"><span> を使用して </span></span><code>gameLoop()</code><span lang="ja"><span> を再び実行して次のアニメーションフレームを要求します。</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">function</span> <span class="function token">buttonPressed</span><span class="punctuation token">(</span>b<span class="punctuation token">)</span> <span class="punctuation token">{</span>
  <span class="keyword token">if</span> <span class="punctuation token">(</span><span class="keyword token">typeof</span><span class="punctuation token">(</span>b<span class="punctuation token">)</span> <span class="operator token">==</span> <span class="string token">"object"</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">return</span> b<span class="punctuation token">.</span>pressed<span class="punctuation token">;</span>
  <span class="punctuation token">}</span>
  <span class="keyword token">return</span> b <span class="operator token">==</span> <span class="number token">1.0</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>

<span class="keyword token">function</span> <span class="function token">gameLoop</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
  <span class="keyword token">var</span> gamepads <span class="operator token">=</span> navigator<span class="punctuation token">.</span>getGamepads <span class="operator token">?</span> navigator<span class="punctuation token">.</span><span class="function token">getGamepads</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">:</span> <span class="punctuation token">(</span>navigator<span class="punctuation token">.</span>webkitGetGamepads <span class="operator token">?</span> navigator<span class="punctuation token">.</span>webkitGetGamepads <span class="punctuation token">:</span> <span class="punctuation token">[</span><span class="punctuation token">]</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
  <span class="keyword token">if</span> <span class="punctuation token">(</span><span class="operator token">!</span>gamepads<span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">return</span><span class="punctuation token">;</span>
  <span class="punctuation token">}</span>

  <span class="keyword token">var</span> gp <span class="operator token">=</span> gamepads<span class="punctuation token">[</span><span class="number token">0</span><span class="punctuation token">]</span><span class="punctuation token">;</span>
  <span class="keyword token">if</span> <span class="punctuation token">(</span><span class="function token">buttonPressed</span><span class="punctuation token">(</span>gp<span class="punctuation token">.</span>buttons<span class="punctuation token">[</span><span class="number token">0</span><span class="punctuation token">]</span><span class="punctuation token">)</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
    b<span class="operator token">--</span><span class="punctuation token">;</span>
  <span class="punctuation token">}</span> <span class="keyword token">else</span> <span class="keyword token">if</span> <span class="punctuation token">(</span><span class="function token">buttonPressed</span><span class="punctuation token">(</span>gp<span class="punctuation token">.</span>buttons<span class="punctuation token">[</span><span class="number token">2</span><span class="punctuation token">]</span><span class="punctuation token">)</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
    b<span class="operator token">++</span><span class="punctuation token">;</span>
  <span class="punctuation token">}</span>
  <span class="keyword token">if</span> <span class="punctuation token">(</span><span class="function token">buttonPressed</span><span class="punctuation token">(</span>gp<span class="punctuation token">.</span>buttons<span class="punctuation token">[</span><span class="number token">1</span><span class="punctuation token">]</span><span class="punctuation token">)</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
    a<span class="operator token">++</span><span class="punctuation token">;</span>
  <span class="punctuation token">}</span> <span class="keyword token">else</span> <span class="keyword token">if</span> <span class="punctuation token">(</span><span class="function token">buttonPressed</span><span class="punctuation token">(</span>gp<span class="punctuation token">.</span>buttons<span class="punctuation token">[</span><span class="number token">3</span><span class="punctuation token">]</span><span class="punctuation token">)</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
    a<span class="operator token">--</span><span class="punctuation token">;</span>
  <span class="punctuation token">}</span>

  ball<span class="punctuation token">.</span>style<span class="punctuation token">.</span>left <span class="operator token">=</span> a <span class="operator token">*</span> <span class="number token">2</span> <span class="operator token">+</span> <span class="string token">"px"</span><span class="punctuation token">;</span>
  ball<span class="punctuation token">.</span>style<span class="punctuation token">.</span>top <span class="operator token">=</span> b <span class="operator token">*</span> <span class="number token">2</span> <span class="operator token">+</span> <span class="string token">"px"</span><span class="punctuation token">;</span>

  start <span class="operator token">=</span> <span class="function token">requestAnimationFrame</span><span class="punctuation token">(</span>gameLoop<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span></code></pre>

<h3 id="軸情報の使用">軸情報の使用</h3>

<p><strong>TBD</strong><span id="result_box" lang="ja"><span><strong> </strong></span></span><strong>(FirefoxとChromeの両方で button[i].value ではなく axes[i] を使う以外は基本的に同じです。)</strong></p>

<h2 id="完全な例_ゲームパッドの状態を表示する">完全な例: ゲームパッドの状態を表示する</h2>

<p><span id="result_box" lang="ja"><span>この例では、</span></span>{{ domxref("Gamepad") }}<span lang="ja"><span>オブジェクト、</span></span>{{ event("gamepadconnected") }}<span lang="ja"><span>イベント、</span></span>{{ event("gamepaddisconnected") }}<span lang="ja"><span>イベントを使用して</span><span>システムに接続されているすべてのゲームパッドの状態を表示します。</span></span><a href="http://luser.github.io/gamepadtest/">デモを見て</a><span lang="ja"><span>、Githubの</span></span><a href="https://github.com/luser/gamepadtest">完全なソースコード</a><span lang="ja"><span>を見ることができます。</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">var</span> haveEvents <span class="operator token">=</span> <span class="string token">'ongamepadconnected'</span> <span class="keyword token">in</span> window<span class="punctuation token">;</span>
<span class="keyword token">var</span> controllers <span class="operator token">=</span> <span class="punctuation token">{</span><span class="punctuation token">}</span><span class="punctuation token">;</span>

<span class="keyword token">function</span> <span class="function token">connecthandler</span><span class="punctuation token">(</span>e<span class="punctuation token">)</span> <span class="punctuation token">{</span>
  <span class="function token">addgamepad</span><span class="punctuation token">(</span>e<span class="punctuation token">.</span>gamepad<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>

<span class="keyword token">function</span> <span class="function token">addgamepad</span><span class="punctuation token">(</span>gamepad<span class="punctuation token">)</span> <span class="punctuation token">{</span>
  controllers<span class="punctuation token">[</span>gamepad<span class="punctuation token">.</span>index<span class="punctuation token">]</span> <span class="operator token">=</span> gamepad<span class="punctuation token">;</span>

  <span class="keyword token">var</span> d <span class="operator token">=</span> document<span class="punctuation token">.</span><span class="function token">createElement</span><span class="punctuation token">(</span><span class="string token">"div"</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
  d<span class="punctuation token">.</span><span class="function token">setAttribute</span><span class="punctuation token">(</span><span class="string token">"id"</span><span class="punctuation token">,</span> <span class="string token">"controller"</span> <span class="operator token">+</span> gamepad<span class="punctuation token">.</span>index<span class="punctuation token">)</span><span class="punctuation token">;</span>

  <span class="keyword token">var</span> t <span class="operator token">=</span> document<span class="punctuation token">.</span><span class="function token">createElement</span><span class="punctuation token">(</span><span class="string token">"h1"</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
  t<span class="punctuation token">.</span><span class="function token">appendChild</span><span class="punctuation token">(</span>document<span class="punctuation token">.</span><span class="function token">createTextNode</span><span class="punctuation token">(</span><span class="string token">"gamepad: "</span> <span class="operator token">+</span> gamepad<span class="punctuation token">.</span>id<span class="punctuation token">)</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
  d<span class="punctuation token">.</span><span class="function token">appendChild</span><span class="punctuation token">(</span>t<span class="punctuation token">)</span><span class="punctuation token">;</span>

  <span class="keyword token">var</span> b <span class="operator token">=</span> document<span class="punctuation token">.</span><span class="function token">createElement</span><span class="punctuation token">(</span><span class="string token">"div"</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
  b<span class="punctuation token">.</span>className <span class="operator token">=</span> <span class="string token">"buttons"</span><span class="punctuation token">;</span>
  <span class="keyword token">for</span> <span class="punctuation token">(</span><span class="keyword token">var</span> i <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">;</span> i <span class="operator token">&lt;</span> gamepad<span class="punctuation token">.</span>buttons<span class="punctuation token">.</span>length<span class="punctuation token">;</span> i<span class="operator token">++</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">var</span> e <span class="operator token">=</span> document<span class="punctuation token">.</span><span class="function token">createElement</span><span class="punctuation token">(</span><span class="string token">"span"</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    e<span class="punctuation token">.</span>className <span class="operator token">=</span> <span class="string token">"button"</span><span class="punctuation token">;</span>
    <span class="comment token">//e.id = "b" + i;</span>
    e<span class="punctuation token">.</span>innerHTML <span class="operator token">=</span> i<span class="punctuation token">;</span>
    b<span class="punctuation token">.</span><span class="function token">appendChild</span><span class="punctuation token">(</span>e<span class="punctuation token">)</span><span class="punctuation token">;</span>
  <span class="punctuation token">}</span>

  d<span class="punctuation token">.</span><span class="function token">appendChild</span><span class="punctuation token">(</span>b<span class="punctuation token">)</span><span class="punctuation token">;</span>

  <span class="keyword token">var</span> a <span class="operator token">=</span> document<span class="punctuation token">.</span><span class="function token">createElement</span><span class="punctuation token">(</span><span class="string token">"div"</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
  a<span class="punctuation token">.</span>className <span class="operator token">=</span> <span class="string token">"axes"</span><span class="punctuation token">;</span>

  <span class="keyword token">for</span> <span class="punctuation token">(</span><span class="keyword token">var</span> i <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">;</span> i <span class="operator token">&lt;</span> gamepad<span class="punctuation token">.</span>axes<span class="punctuation token">.</span>length<span class="punctuation token">;</span> i<span class="operator token">++</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">var</span> p <span class="operator token">=</span> document<span class="punctuation token">.</span><span class="function token">createElement</span><span class="punctuation token">(</span><span class="string token">"progress"</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    p<span class="punctuation token">.</span>className <span class="operator token">=</span> <span class="string token">"axis"</span><span class="punctuation token">;</span>
    <span class="comment token">//p.id = "a" + i;</span>
    p<span class="punctuation token">.</span><span class="function token">setAttribute</span><span class="punctuation token">(</span><span class="string token">"max"</span><span class="punctuation token">,</span> <span class="string token">"2"</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    p<span class="punctuation token">.</span><span class="function token">setAttribute</span><span class="punctuation token">(</span><span class="string token">"value"</span><span class="punctuation token">,</span> <span class="string token">"1"</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    p<span class="punctuation token">.</span>innerHTML <span class="operator token">=</span> i<span class="punctuation token">;</span>
    a<span class="punctuation token">.</span><span class="function token">appendChild</span><span class="punctuation token">(</span>p<span class="punctuation token">)</span><span class="punctuation token">;</span>
  <span class="punctuation token">}</span>

  d<span class="punctuation token">.</span><span class="function token">appendChild</span><span class="punctuation token">(</span>a<span class="punctuation token">)</span><span class="punctuation token">;</span>

  <span class="comment token">// See https://github.com/luser/gamepadtest/blob/master/index.html</span>
  <span class="keyword token">var</span> start <span class="operator token">=</span> document<span class="punctuation token">.</span><span class="function token">getElementById</span><span class="punctuation token">(</span><span class="string token">"start"</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
  <span class="keyword token">if</span> <span class="punctuation token">(</span>start<span class="punctuation token">)</span> <span class="punctuation token">{</span>
    start<span class="punctuation token">.</span>style<span class="punctuation token">.</span>display <span class="operator token">=</span> <span class="string token">"none"</span><span class="punctuation token">;</span>
  <span class="punctuation token">}</span>

  document<span class="punctuation token">.</span>body<span class="punctuation token">.</span><span class="function token">appendChild</span><span class="punctuation token">(</span>d<span class="punctuation token">)</span><span class="punctuation token">;</span>
  <span class="function token">requestAnimationFrame</span><span class="punctuation token">(</span>updateStatus<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>

<span class="keyword token">function</span> <span class="function token">disconnecthandler</span><span class="punctuation token">(</span>e<span class="punctuation token">)</span> <span class="punctuation token">{</span>
  <span class="function token">removegamepad</span><span class="punctuation token">(</span>e<span class="punctuation token">.</span>gamepad<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>

<span class="keyword token">function</span> <span class="function token">removegamepad</span><span class="punctuation token">(</span>gamepad<span class="punctuation token">)</span> <span class="punctuation token">{</span>
  <span class="keyword token">var</span> d <span class="operator token">=</span> document<span class="punctuation token">.</span><span class="function token">getElementById</span><span class="punctuation token">(</span><span class="string token">"controller"</span> <span class="operator token">+</span> gamepad<span class="punctuation token">.</span>index<span class="punctuation token">)</span><span class="punctuation token">;</span>
  document<span class="punctuation token">.</span>body<span class="punctuation token">.</span><span class="function token">removeChild</span><span class="punctuation token">(</span>d<span class="punctuation token">)</span><span class="punctuation token">;</span>
  <span class="keyword token">delete</span> controllers<span class="punctuation token">[</span>gamepad<span class="punctuation token">.</span>index<span class="punctuation token">]</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>

<span class="keyword token">function</span> <span class="function token">updateStatus</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
  <span class="keyword token">if</span> <span class="punctuation token">(</span><span class="operator token">!</span>haveEvents<span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="function token">scangamepads</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
  <span class="punctuation token">}</span>

  <span class="keyword token">var</span> i <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">;</span>
  <span class="keyword token">var</span> j<span class="punctuation token">;</span>

  <span class="keyword token">for</span> <span class="punctuation token">(</span>j <span class="keyword token">in</span> controllers<span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">var</span> controller <span class="operator token">=</span> controllers<span class="punctuation token">[</span>j<span class="punctuation token">]</span><span class="punctuation token">;</span>
    <span class="keyword token">var</span> d <span class="operator token">=</span> document<span class="punctuation token">.</span><span class="function token">getElementById</span><span class="punctuation token">(</span><span class="string token">"controller"</span> <span class="operator token">+</span> j<span class="punctuation token">)</span><span class="punctuation token">;</span>
    <span class="keyword token">var</span> buttons <span class="operator token">=</span> d<span class="punctuation token">.</span><span class="function token">getElementsByClassName</span><span class="punctuation token">(</span><span class="string token">"button"</span><span class="punctuation token">)</span><span class="punctuation token">;</span>

    <span class="keyword token">for</span> <span class="punctuation token">(</span>i <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">;</span> i <span class="operator token">&lt;</span> controller<span class="punctuation token">.</span>buttons<span class="punctuation token">.</span>length<span class="punctuation token">;</span> i<span class="operator token">++</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
      <span class="keyword token">var</span> b <span class="operator token">=</span> buttons<span class="punctuation token">[</span>i<span class="punctuation token">]</span><span class="punctuation token">;</span>
      <span class="keyword token">var</span> val <span class="operator token">=</span> controller<span class="punctuation token">.</span>buttons<span class="punctuation token">[</span>i<span class="punctuation token">]</span><span class="punctuation token">;</span>
      <span class="keyword token">var</span> pressed <span class="operator token">=</span> val <span class="operator token">==</span> <span class="number token">1.0</span><span class="punctuation token">;</span>
      <span class="keyword token">if</span> <span class="punctuation token">(</span><span class="keyword token">typeof</span><span class="punctuation token">(</span>val<span class="punctuation token">)</span> <span class="operator token">==</span> <span class="string token">"object"</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
        pressed <span class="operator token">=</span> val<span class="punctuation token">.</span>pressed<span class="punctuation token">;</span>
        val <span class="operator token">=</span> val<span class="punctuation token">.</span>value<span class="punctuation token">;</span>
      <span class="punctuation token">}</span>

      <span class="keyword token">var</span> pct <span class="operator token">=</span> Math<span class="punctuation token">.</span><span class="function token">round</span><span class="punctuation token">(</span>val <span class="operator token">*</span> <span class="number token">100</span><span class="punctuation token">)</span> <span class="operator token">+</span> <span class="string token">"%"</span><span class="punctuation token">;</span>
      b<span class="punctuation token">.</span>style<span class="punctuation token">.</span>backgroundSize <span class="operator token">=</span> pct <span class="operator token">+</span> <span class="string token">" "</span> <span class="operator token">+</span> pct<span class="punctuation token">;</span>

      <span class="keyword token">if</span> <span class="punctuation token">(</span>pressed<span class="punctuation token">)</span> <span class="punctuation token">{</span>
        b<span class="punctuation token">.</span>className <span class="operator token">=</span> <span class="string token">"button pressed"</span><span class="punctuation token">;</span>
      <span class="punctuation token">}</span> <span class="keyword token">else</span> <span class="punctuation token">{</span>
        b<span class="punctuation token">.</span>className <span class="operator token">=</span> <span class="string token">"button"</span><span class="punctuation token">;</span>
      <span class="punctuation token">}</span>
    <span class="punctuation token">}</span>

    <span class="keyword token">var</span> axes <span class="operator token">=</span> d<span class="punctuation token">.</span><span class="function token">getElementsByClassName</span><span class="punctuation token">(</span><span class="string token">"axis"</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    <span class="keyword token">for</span> <span class="punctuation token">(</span>i <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">;</span> i <span class="operator token">&lt;</span> controller<span class="punctuation token">.</span>axes<span class="punctuation token">.</span>length<span class="punctuation token">;</span> i<span class="operator token">++</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
      <span class="keyword token">var</span> a <span class="operator token">=</span> axes<span class="punctuation token">[</span>i<span class="punctuation token">]</span><span class="punctuation token">;</span>
      a<span class="punctuation token">.</span>innerHTML <span class="operator token">=</span> i <span class="operator token">+</span> <span class="string token">": "</span> <span class="operator token">+</span> controller<span class="punctuation token">.</span>axes<span class="punctuation token">[</span>i<span class="punctuation token">]</span><span class="punctuation token">.</span><span class="function token">toFixed</span><span class="punctuation token">(</span><span class="number token">4</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
      a<span class="punctuation token">.</span><span class="function token">setAttribute</span><span class="punctuation token">(</span><span class="string token">"value"</span><span class="punctuation token">,</span> controller<span class="punctuation token">.</span>axes<span class="punctuation token">[</span>i<span class="punctuation token">]</span> <span class="operator token">+</span> <span class="number token">1</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    <span class="punctuation token">}</span>
  <span class="punctuation token">}</span>

  <span class="function token">requestAnimationFrame</span><span class="punctuation token">(</span>updateStatus<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>

<span class="keyword token">function</span> <span class="function token">scangamepads</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
  <span class="keyword token">var</span> gamepads <span class="operator token">=</span> navigator<span class="punctuation token">.</span>getGamepads <span class="operator token">?</span> navigator<span class="punctuation token">.</span><span class="function token">getGamepads</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">:</span> <span class="punctuation token">(</span>navigator<span class="punctuation token">.</span>webkitGetGamepads <span class="operator token">?</span> navigator<span class="punctuation token">.</span><span class="function token">webkitGetGamepads</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">:</span> <span class="punctuation token">[</span><span class="punctuation token">]</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
  <span class="keyword token">for</span> <span class="punctuation token">(</span><span class="keyword token">var</span> i <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">;</span> i <span class="operator token">&lt;</span> gamepads<span class="punctuation token">.</span>length<span class="punctuation token">;</span> i<span class="operator token">++</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">if</span> <span class="punctuation token">(</span>gamepads<span class="punctuation token">[</span>i<span class="punctuation token">]</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
      <span class="keyword token">if</span> <span class="punctuation token">(</span>gamepads<span class="punctuation token">[</span>i<span class="punctuation token">]</span><span class="punctuation token">.</span>index <span class="keyword token">in</span> controllers<span class="punctuation token">)</span> <span class="punctuation token">{</span>
        controllers<span class="punctuation token">[</span>gamepads<span class="punctuation token">[</span>i<span class="punctuation token">]</span><span class="punctuation token">.</span>index<span class="punctuation token">]</span> <span class="operator token">=</span> gamepads<span class="punctuation token">[</span>i<span class="punctuation token">]</span><span class="punctuation token">;</span>
      <span class="punctuation token">}</span> <span class="keyword token">else</span> <span class="punctuation token">{</span>
        <span class="function token">addgamepad</span><span class="punctuation token">(</span>gamepads<span class="punctuation token">[</span>i<span class="punctuation token">]</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
      <span class="punctuation token">}</span>
    <span class="punctuation token">}</span>
  <span class="punctuation token">}</span>
<span class="punctuation token">}</span>


window<span class="punctuation token">.</span><span class="function token">addEventListener</span><span class="punctuation token">(</span><span class="string token">"gamepadconnected"</span><span class="punctuation token">,</span> connecthandler<span class="punctuation token">)</span><span class="punctuation token">;</span>
window<span class="punctuation token">.</span><span class="function token">addEventListener</span><span class="punctuation token">(</span><span class="string token">"gamepaddisconnected"</span><span class="punctuation token">,</span> disconnecthandler<span class="punctuation token">)</span><span class="punctuation token">;</span>

<span class="keyword token">if</span> <span class="punctuation token">(</span><span class="operator token">!</span>haveEvents<span class="punctuation token">)</span> <span class="punctuation token">{</span>
  <span class="function token">setInterval</span><span class="punctuation token">(</span>scangamepads<span class="punctuation token">,</span> <span class="number token">500</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span></code></pre>

<h2 id="仕様">仕様</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <th scope="col">仕様</th>
   <th scope="col">状態</th>
   <th scope="col">コメント</th>
  </tr>
  <tr>
   <td>{{SpecName("Gamepad", "#gamepad-interface", "Gamepad")}}</td>
   <td>{{Spec2("Gamepad")}}</td>
   <td>初版</td>
  </tr>
 </tbody>
</table>

<h2 id="ブラウザの互換性">ブラウザの互換性</h2>

<p> </p>

<div class="hidden">
<p>The compatibility table on this page is generated from structured data. If you'd like to contribute to the data, please check out <a href="https://github.com/mdn/browser-compat-data">https://github.com/mdn/browser-compat-data</a> and send us a pull request.</p>
</div>

<p>{{Compat("api.Gamepad")}}</p>

<p> </p>