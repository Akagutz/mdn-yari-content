<div>{{JSRef}}</div>

<p><strong><code>Atomics</code></strong> オブジェクトは、静的なメソッドのアトミック演算を提供します。これらのメソッドは、{{jsxref("SharedArrayBuffer")}} オブジェクトで使用されます。</p>

<p>アトミック演算は、<code>Atomics</code> モジュール上にインストールされます。他のグローバルオブジェクトと異なり、<code>Atomics</code> はコンストラクターではありません。<a href="/docs/Web/JavaScript/Reference/Operators/new"><code>new</code> 演算子</a> を付けて使用することや <code>Atomics</code> オブジェクトを関数として実行することはできません。<code>Atomics</code> のすべてのプロパティとメソッドは静的です (例えば、{{jsxref("Math")}} オブジェクトの場合と同じです)。</p>

<h2 id="Properties" name="Properties">プロパティ</h2>

<dl>
 <dt><code>Atomics[Symbol.toStringTag]</code></dt>
 <dd>このプロパティの値は "Atomics" です。</dd>
</dl>

<h2 id="メソッド">メソッド</h2>

<h3 id="不可分操作">不可分操作</h3>

<p>メモリーが共有されている場合、複数のスレッドがメモリー内の同じデータを読み書きできます。アトミック演算では、予測される値の書き込みと読み込みを保証するため、次の演算が開始される前に現在の演算が完了し、その演算が割り込まれないようにします。</p>

<dl>
 <dt>{{jsxref("Atomics.add()")}}</dt>
 <dd>配列の指定位置に値を追加します。その位置の古い値を返します。</dd>
 <dt>{{jsxref("Atomics.and()")}}</dt>
 <dd>配列の指定位置の値と指定した値の論理積 (AND) をビット演算します。その位置の古い値を返します。</dd>
 <dt>{{jsxref("Atomics.compareExchange()")}}</dt>
 <dd>指定した値が等しければ、配列の指定位置の値と指定した値を交換して格納します。古い値を返します。</dd>
 <dt>{{jsxref("Atomics.exchange()")}}</dt>
 <dd>配列の指定位置の値と指定した値を交換して格納します。古い値を返します。</dd>
 <dt>{{jsxref("Atomics.load()")}}</dt>
 <dd>配列の指定位置の値を返します。</dd>
 <dt>{{jsxref("Atomics.or()")}}</dt>
 <dd>配列の指定位置の値と指定した値の論理和 (OR) をビット演算します。その位置の古い値を返します。</dd>
 <dt>{{jsxref("Atomics.store()")}}</dt>
 <dd>配列の指定位置に指定した値を格納します。その値を返します。</dd>
 <dt>{{jsxref("Atomics.sub()")}}</dt>
 <dd>配列の指定位置の値から指定した値を減算します。その位置の古い値を返します。</dd>
 <dt>{{jsxref("Atomics.xor()")}}</dt>
 <dd>配列の指定位置の値と指定した値の排他的論理和 (XOR) をビット演算します。その位置の古い値を返します。</dd>
</dl>

<h3 id="wait_メソッドと_wake_メソッド">wait メソッドと wake メソッド</h3>

<p><code>wait()</code> メソッドと <code>wake()</code> メソッドは、Linux の futex ("fast user-space mutex") を原型としており、特定の条件が true になるまで待つ手段を提供します。一般的にはブロッキングコンストラクト (blocking constructs) として使用されます。</p>

<dl>
 <dt>{{jsxref("Atomics.wait()")}}</dt>
 <dd>配列の指定位置に指定した値が含まれているか検証し、スリープで待機するかタイムアウトします。<code>"ok"</code>, <code>"not-equal"</code>, <code>"timed-out"</code> のいずれかの文字列を返します。呼び出したエージェントで待機が許可されていない場合、Error 例外を投げます (ほとんどのブラウザーは、ブラウザーのメインスレッドで <code>wait()</code> を許可しません。)。</dd>
 <dt>{{jsxref("Atomics.wake()")}}</dt>
 <dd>配列の指定位置の wait キューでスリープ中のエージェントを起動します。起動したエージェントの数を返します。</dd>
 <dt>{{jsxref("Atomics.isLockFree()", "Atomics.isLockFree(size)")}}</dt>
 <dd>ロック機構とアトミック演算のどちらを使用するかを決定するための最適化プリミティブです。指定した要素サイズの配列上のアトミック演算がハードウェアによるアトミック演算を使用するよう実装されている場合、<code>true</code> を返します (それに対してロックの場合は <code>false</code> を返します)。専門家だけが使用してください。</dd>
</dl>

<h2 id="仕様">仕様</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <th scope="col">仕様書</th>
   <th scope="col">策定状況</th>
   <th scope="col">コメント</th>
  </tr>
  <tr>
   <td>{{SpecName('ESDraft', '#sec-atomics-object', 'Atomics')}}</td>
   <td>{{Spec2('ESDraft')}}</td>
   <td>ES2017 で初期定義。</td>
  </tr>
  <tr>
   <td>{{SpecName('ES8', '#sec-atomics-object', 'Atomics')}}</td>
   <td>{{Spec2('ES8')}}</td>
   <td> </td>
  </tr>
 </tbody>
</table>

<h2 id="ブラウザー実装状況">ブラウザー実装状況</h2>

<div class="hidden">The compatibility table on this page is generated from structured data. If you'd like to contribute to the data, please check out <a href="https://github.com/mdn/browser-compat-data">https://github.com/mdn/browser-compat-data</a> and send us a pull request.</div>

<p>{{Compat("javascript.builtins.Atomics")}}</p>

<h2 id="互換性ノート">互換性ノート</h2>

<p>Firefox 48 より前のバージョンでは、最新の API 名とセマンティクスがまだ実装されていませんでした。Firefox バージョン 46 とバージョン 48 の間の変更点は次のとおりです:</p>

<ul>
 <li><code>Atomics.futexWakeOrRequeue()</code> および <code>Atomics.fence()</code> メソッドは完全に削除されました ({{bug(1259544)}} と {{bug(1225028)}})。</li>
 <li>{{jsxref("Atomics.wait()")}} および {{jsxref("Atomics.wake()")}} の以前のメソッド名は <code>Atomics.futexWait()</code> と <code>Atomics.futexWake()</code> ({{bug(1260910)}}) でした。注記: 古いメソッド名はバージョン 49 以降で削除されました ({{bug(1262062)}})。</li>
 <li><code>Atomics.OK</code>, <code>Atomics.TIMEDOUT</code>, <code>Atomics.NOTEQUAL</code> プロパティは削除されました。{{jsxref("Atomics.wait()")}} メソッドが文字列の "ok", "timed-out", "not-equal" を返します ({{bug(1260835)}})。</li>
 <li>{{jsxref("Atomics.wake()")}} メソッドの <code>count</code> 引数が変更されました: デフォルト値が <code>0</code> ではなく、<code>+Infinity</code> になります ({{bug(1253350)}})。</li>
</ul>

<h2 id="関連項目">関連項目</h2>

<ul>
 <li>{{jsxref("ArrayBuffer")}}</li>
 <li><a href="/docs/Web/JavaScript/Typed_arrays">JavaScript typed arrays</a></li>
 <li><a href="/docs/Web/API/Web_Workers_API">Web Workers</a></li>
 <li><a href="https://github.com/lars-t-hansen/parlib-simple">parlib-simple</a> – 同期と分配の抽象化を行うシンプルなライブラリ。</li>
 <li><a href="https://github.com/tc39/ecmascript_sharedmem/blob/master/TUTORIAL.md">Shared Memory – 簡潔なチュートリアル</a></li>
 <li><a href="https://dev.mozilla.jp/2016/05/a-taste-of-javascripts-new-parallel-primitives/">JavaScript の並列処理機能を味見してみる</a></li>
</ul>