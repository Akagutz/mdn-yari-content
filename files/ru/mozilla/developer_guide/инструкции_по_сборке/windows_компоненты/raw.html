
<p>Эта страница описывает необходимые шаги, чтобы подготовить компьютер к построению версии Firefox и/или Thunderbird на Windows.</p>

<h2 id="Системные_требования"><span class="yt-dictionary-meaning">Системные требования</span></h2>

<p>Построение программного обеспечения Mozilla может занять много времени,  даже на современном оборудовании. Минимальные системные требования, необходимое для разработки Mozilla:</p>

<ul>
 <li>По крайней мере, 3 Гб оперативной памяти для построения последней версии Firefox; Рекомендуется 4 Гб или более.</li>
 <li>
  <div class="yt-area-textbox yt-area-textbox__textbox" id="dstTextBox">20 ГБ свободного дискового пространства (для Visual Studio 2010 Express, SDK, MozillaBuild, исходного кода и свободного пространства, необходимого для компиляции.)</div>
 </li>
 <li>
  <div class="yt-area-textbox yt-area-textbox__textbox" id="dstTextBox">Рекомендуется Windows Vista или более поздняя версия, хотя можно построить на Windows XP. Windows 2000 и более ранние версии не поддерживаются.</div>
 </li>
</ul>

<h2 id="Общие_сведения">Общие сведения</h2>

<p>Процесс построения Mozilla требует много средств, которые не установлены на большинстве систем Windows. В дополнение к Visual Studio, вы должны установить MozillaBuild, который представляет собой пакет программного обеспечения, в том числе bash, GNU make, autoconf, Mercurial, и многое другое.</p>

<p>Исходный код Mozilla работает на Visual Studio 2010 (VC10) и Visual Studio 2012 (VC11) . Официальные выпуски продуктов Mozilla Foundation компилируются на VC10.</p>

<h2 id="Подготовка_к_установке">Подготовка к установке</h2>

<p>Завершите каждый из этих шагов, в противном случае вы не сможете успешно построить Firefox и/или Thunderbird. Есть замечания к программным ресурсам ниже.</p>

<ol>
 <li>Убедитесь, что у вас последняя версия системы с помощью Windows Update. (Для Windows XP необходимо как минимум <a href="http://www.microsoft.com/windowsxp/sp2/default.mspx">Service Pack 2</a> и <a href="http://www.microsoft.com/downloads/info.aspx?na=47&amp;p=3&amp;SrcDisplayLang=en&amp;SrcCategoryId=&amp;SrcFamilyId=4377f86d-c913-4b5c-b87e-ef72e5b4e065&amp;u=details.aspx?familyid=0856EACB-4362-4B0D-8EDD-AAB15C5E04F5&amp;displaylang=en">.NET Framework 2.0</a>.).</li>
 <li>Если вы работаете с Windows 7 и хотите использовать Express-версии Visual Studio 2010, установите <a href="https://developer.mozilla.org/en-US/docs/Windows_SDK_versions#Windows_7_SDK" title="Windows SDK versions">Windows 7 SDK</a>.</li>
 <li>Установите <a href="http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=6812" title="http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=6812">June 2010 DirectX SDK</a> (даже VS 2012 требует этого). (Если ранее был установлен Visual C++ 2010 года, вы можете столкнуться с ошибкой "S1023" во время установки. Для коррекции действий, см.<a href="http://blogs.msdn.com/b/chuckw/archive/2011/12/09/known-issue-directx-sdk-june-2010-setup-and-the-s1023-error.aspx"> известная проблема: DirectX SDK (июнь 2010 года) установка программы и S1023 ошибка</a> на "Games for Windows и DirectX SDK" блоге.)</li>
 <li>
  <div class="yt-area-textbox yt-area-textbox__textbox" id="dstTextBox">Установите одно из этого:<a href="http://www.microsoft.com/visualstudio/eng/downloads"> Visual Studio 2012 для Windows Desktop Pro</a>  или  экспресс (бесплатный) или Visual Studio 2010 Pro  или <a href="http://go.microsoft.com/?linkid=9709949"> экспресс (бесплатно)</a>.</div>
 </li>
 <li>Скачайте и запустите <a href="https://ftp.mozilla.org/pub/mozilla.org/mozilla/libraries/win32/MozillaBuildSetup-Latest.exe">MozillaBuild</a> пакет, содержащий дополнительные инструменты для сборки. Если у вас установлен cygwin, прочитайте запись в разделе советы. (После завершения работы MozillaBuild программа установки, если вы видите ошибку Windows которая, просит вас повторно установить с  "правильной настройки", выберите эту опцию, и после этого все должно быть хорошо.) Больше информации о MozillaBuild и ссылки на новые версии доступны на <a href="https://wiki.mozilla.org/MozillaBuild">https://wiki.mozilla.org/MozillaBuild</a>.</li>
 <li>Если вы намерены построить Firefox Windows 8 UI (ранее известный, как " метро"), посмотрите дополнительные сведения, расположенном в <a href="https://wiki.mozilla.org/index.php?title=Firefox/Windows_8_Integration#Building_Locally">интеграция Windows 8 - здание на месте</a>.</li>
</ol>

<p>В некоторых случаях могут возникнуть следующие проблемы:</p>

<p style="margin-left: 40px;"><strong>Если вы используете Visual Studio 2010:</strong></p>

<ul>
 <li style="margin-left: 40px;">Установка .NET Framework 4.5 при использовании Visual Studio 2010 RTM сборки. Установка Visual Studio 2010 SP1 исправляет эту проблему: см. <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=772989">Bug 772989</a> комментарии 15 и 17 и <a href="http://support.microsoft.com/kb/2757355">http://support.microsoft.com/kb/2757355</a> для получения дополнительной информации.</li>
</ul>

<dl>
 <dt style="margin-left: 40px;">Если вы используете Visual Studio 2012:</dt>
</dl>

<ul style="margin-left: 40px;">
 <li>
  <div class="yt-area-textbox yt-area-textbox__textbox" id="dstTextBox">При построении Thunderbird или SeaMonkey, вы должны установить заголовочные файлы с MAPI <a href="http://www.microsoft.com/en-us/download/details.aspx?id=12905">http://www.microsoft.com/en-us/download/details.aspx?id=12905</a> потому что MAPI заголовочные файлы не входят в комплект Visual Studio 2012 (Windows SDK 8.0). Вы должны скопировать файлы заголовков для Windows SDK включая каталог, таким образом, процесс построения найдете файлы, например, <code>C:\Program Files (x86)\Windows Kits\8.0\Include\shared.</code></div>
 </li>
</ul>

<dl>
 <dt style="margin-left: 40px;">Если вы получаете сообщения об отсутствующих dll-файлов в процессе установки:</dt>
</dl>

<ul style="margin-left: 40px;">
 <li>Вам нужно найти папку(и), содержащюю(ие) каждый отсутствующий dll и добавьте их в переменную среды PATH (в расширенных системных настройках).<span id="cke_bm_111C" style="display: none;"> </span></li>
</ul>

<p>Пожалуйста, Запомните, что Mozilla не будет строить, если некоторые из инструментов, установленных на путь, который содержит пробелы или другое недопустимые символы, такие как плюсы, кавычки, или метасимволы. Visual Studio tools являются исключением-они могут быть установлены в каталог, который содержит пробелы. Настоятельно рекомендуется принять параметры по умолчанию для всех путей установки.</p>

<h2 id="Открытие_построения_командной_строкой">Открытие построения командной строкой</h2>

<p>После установки необходимых обновлений, запустите один из следующих пакетных файлов из каталога, в котором установлен MozillaBuild (<code>c:\mozilla-build</code> по умолчанию):</p>

<ul>
 <li><code>start-shell-msvc2010.bat (для Visual Studio 2010)</code></li>
 <li><code>start-shell-msvc2012.bat (для Visual Studio 2012)</code></li>
 <li><code>start-shell-msvc2013.bat (<code>для Visual Studio</code> 2013)</code></li>
</ul>

<div class="warning"><span style="color: #ffffff;"><strong>Даже если у вас 64-битная версия Windows, не следует пользоваться <code>start-shell-msvcNNNN-x64.bat</code> файлами </strong>(Если вы не знаете, что делаете).Эти файлы являются<strong> экспериментальными и не поддерживается</strong>. См.</span> <a href="http://wiki.mozilla-x86-64.com/How_To_Build_Windows_x64_Build" title="http://wiki.mozilla-x86-64.com/How_To_Build_Windows_x64_Build">Build:MozillaBuild For x64 wiki page</a>. </div>

<div class="yt-area-textbox yt-area-textbox__textbox" id="dstTextBox">Этот запуск MSYS / BASH prompt правильно настроен, чтобы построить одну из вышеупомянутых базы кода. Все последующие команды должны быть выполнены в этом окне командной строки. (Обратите внимание, что это же не то, что вы получаете с Windows CMD.EXE shell).</div>

<div class="yt-area-textbox yt-area-textbox__textbox"> </div>

<p>Это должно быть выполнено с правами администратора. Если у вас User Account Control (UAC) включен, он не может быть предоставлен автоматически. Кликните правой кнопкой мыши на .BAT файле и выберите "запуск от имени администратора".</p>

<h2 id="Создание_каталога_для_исходного_кода">Создание каталога для исходного кода</h2>

<div class="note"><strong>Note:</strong> Вы не сможете построить исходный код Firefox, если он нажодится в каталоге, название которого содержит пробелы (например, не используйте "Documents and Settings"). Вы можете выбрать любое другое место, например, новый каталог C:\mozilla-central.</div>

<p>Это хорошая идея, создать каталог для исходного кода:</p>

<pre>cd /c; mkdir mozilla-source; cd mozilla-source</pre>

<p>Теперь вы готовы получить исходники Firefox и построить его; продолжайте: <a href="/en-US/docs/Simple_Firefox_build#Get_the_source" title="Simple_Firefox_build#Get_the_source">Простой метод построения Firefox (Получить исходники).</a></p>

<h2 id="Командная_строка._Советы_и_предостережения">Командная строка. Советы и предостережения</h2>

<ul>
 <li>Для того, чтобы вставить в это окно, нужно щелкнуть правой кнопкой мыши на заголовке окна, наведите курсор на меню " Edit " и нажмите кнопку вставить. Вы также можете установить Quick Edit Mode " в меню " свойства " и щелкнуть правой кнопкой мыши в окне, чтобы вставить свой выбор.</li>
 <li>Если у вас установлен cygwin, убедитесь, что MozillaBuild каталоги предстать перед каких-либо cygwin каталоги в пути поиска (использовать команду echo $PATH, чтобы увидеть вашем пути поиска).</li>
 <li>
  <div class="yt-area-textbox yt-area-textbox__textbox" id="dstTextBox">В MSYS / BASH, c: диск выглядит как корневой каталог (/). Так что если вы хотите, изменить каталог c:\mydir в MSYS оболочки, вы должны использовать cd /c/mydir. Обратите внимание на UNIX-стиль косой черты (/), а не в Windows-стиле обратной косой черты (\).</div>
 </li>
 <li>
  <div class="yt-area-textbox yt-area-textbox__textbox" id="dstTextBox">MSYS корневой каталог находится в c:\mozilla-build\msys, если использовать по умолчанию каталог установки. Это плохая идея, построить что-нибудь в этом каталоге. Вместо этого, используйте что-то вроде /c/mydir.</div>
 </li>
</ul>

<h2 id="Common_problems_hints_and_restrictions">Common problems, hints, and restrictions</h2>

<ul>
 <li><a href="/en-US/docs/Debugging_Mozilla_on_Windows_FAQ" title="Debugging_Mozilla_on_Windows_FAQ">Debugging Mozilla on Windows FAQ</a>: Tips on how to debug Mozilla on Windows.</li>
 <li>Note that in Windows you need to build with Administrator privileges. If you have User Account Control (UAC) turned on, it may not automatically grant that to you.</li>
 <li>The build may fail if your <code>PATH</code> environment variable contains quotes ("). Quotes are not properly translated when passed down to MozillaBuild sub-shells. Quotes are usually not needed so they can be removed.</li>
 <li>The build may fail if you have a <code>PYTHON</code> environment variable set. You will see an error almost immediately that says "<code>The system cannot find the file specified</code>". In a command shell, typing "<code>SET PYTHON=</code>" before running the Mozilla build tools in that same shell should fix this. Make sure that <code>PYTHON</code> is actually unset, rather than set to an empty value. In the command shell, "<code>SET PYTHON</code>" (without no equal sign or quotes) should respond: "<code>Environment variable PYTHON is not defined</code>".</li>
 <li>The build may fail if you have cygwin installed. Make sure that the MozillaBuild directories (<code>c:\mozilla-build</code> and subdirectories) come before any cygwin directories in your PATH environment variable. If this does not help, remove the cygwin directories from PATH, or try building on a clean PC with no cygwin.</li>
 <li>Building with versions of NSIS other than the version that comes with the latest supported version of MozillaBuild is not supported and will likely fail.</li>
 <li>If you intend to distribute your build to others, you will need to set <code>WIN32_REDIST_DIR=$VCINSTALLDIR\redist\x86\Microsoft.VC80.CRT</code> in your mozconfig to get the Microsoft CRT DLLs packaged along with the application.</li>
 <li>The <a href="http://www.microsoft.com/security/malwareremove/default.aspx" title="http://www.microsoft.com/security/malwareremove/default.aspx">Microsoft Antimalware service</a> can interfere with compilation, often manifesting as an error related to <code>conftest.exe</code> during build. To remedy this, add at least your object directory to the <a href="http://social.answers.microsoft.com/Forums/en-US/msescan/thread/0867c974-cf19-460d-a75d-e35f283d4ad3" title="http://social.answers.microsoft.com/Forums/en-US/msescan/thread/0867c974-cf19-460d-a75d-e35f283d4ad3">exclusion settings</a>.</li>
 <li>If you encounter an error that atlbase.h cannot be found and you have installed Visual Studio 10 Express together with the platform SDK, you may have to delete a registry entry so that guess-msvc.bat doesn't detect VC10 installed. The key is HKLM\SOFTWARE\Microsoft\VisualStudio\10.0\Setup\VC.</li>
 <li>If you encounter an error like "second C linkage of overloaded function '_interlockedbittestandset' not allowed", it happens when intrin.h and windows.h are included together. Use a #define to redefine one instance of the function's name. See more on <a href="/en-US/docs/Developer_Guide/Build_Instructions/Intrin.h" title="https://developer.mozilla.org/En/Developer_Guide/Build_Instructions/Intrin.h">using intrin.h</a>.</li>
 <li>Parallel builds (<code>-jN</code>) do not work with GNU make on Windows. You need to use <a href="/en-US/docs/pymake" title="pymake">pymake</a> instead.</li>
</ul>

<p></p><div class="warning">If you follow the below advice, your computer will <strong>not </strong>be protected against attacks that exploit this vulnerability. <strong>Make sure you take adequate precautions.</strong></div><p></p>

<ul>
 <li>If you still get random crashes when running <code>make</code>, you may be encountering interference from Windows Security Updates that prevents proper operation of the Bash shell on some Windows systems. In this case, if you're on Windows XP, you will need to uninstall Windows XP Security Updates KB933729 and KB970238 using Add or Remove Programs from the Control Panel. The first of these Security Updates is also incorporated into Windows XP Service Pack 3 (KB936929), so if you have already installed SP3 you'll need to uninstall it and then make sure that Service Pack 2, including all Windows updates (EXCEPT KB933729, KB936929, and KB970238) get installed. To prevent these updates from being installed automatically, select "Notify me but don't automatically download or install them" in the Control Panel's "Automatic Updates" dialog. Then de-select them when any of these items appear in the list of recommended updates, and when asked, indicate that you don't want to be asked about these de-selected updates in the future.</li>
</ul>

<h3 id="Microsoft_DirectX_SDK">Microsoft DirectX SDK</h3>

<p>The <a href="http://www.microsoft.com/en-us/download/details.aspx?id=6812" title="http://www.microsoft.com/en-us/download/details.aspx?id=6812">June 2010 DirectX SDK</a> (specifically) is required for building the <a href="http://code.google.com/p/angleproject/" title="http://code.google.com/p/angleproject/">ANGLE</a> GLES-on-D3D9 renderer, which is required on Windows for WebGL rendering. (If you don't care about compatibility with official Firefox builds and want to avoid installing this large SDK, you can disable WebGL by building Mozilla with the --disable-webgl option.) As part of the DirectX SDK install, you must install the End-User Redistributable Packages; don't uncheck it in the installer. (At least prior to Win7+VS2012?)</p>

<p>(Note that other versions of the DirectX SDK on Microsoft's Developer Center that claim to have been released after June 2010 are actually <u>older</u> versions that are misdated, some of which will result in an error if you try and download them due to the installer files themselves having been removed from the MS servers. There will not be any further standalone DirectX SDKs released by MS, since DirectX has been transitioned from an independent distribution model to an integrated (into Windows and Visual Studio) model, and the DirectX SDK is now integrated into the Windows 8 SDK (which is bundled with Visual Studio as of VS2012) [<a href="http://blogs.msdn.com/b/chuckw/archive/2012/03/22/where-is-the-directx-sdk.aspx" title="http://blogs.msdn.com/b/chuckw/archive/2012/03/22/where-is-the-directx-sdk.aspx">ref</a>]. The reason that we require the June SDK even on newer Win7+VS2012 systems is because ANGLE depends on D3DX9, but MS considers D3DX to have been obsoleted by newer technologies and therefore VS2012 doesn't include the d3dx9.h and d3dx9tex.h headers that are required to compile ANGLE. Any queries about this paragraph, talk to <a href="/en-US/profiles/Jonathan_Watt" title="profiles/Jonathan_Watt">Jonathan Watt</a>.)</p>

<div class="note">
<p><strong>Note</strong>: The DirectX SDK installer may display an "S1023" error during the final installation step. You may be able to simply ignore this error and continue with the Mozilla build process. If the Mozilla build system still cannot locate the DirectX SDK, <a href="http://support.microsoft.com/kb/2728613">see this Microsoft support page</a>.</p>
</div>

<h3 id="MozillaBuild">MozillaBuild</h3>

<p>The MozillaBuild package contains the other software prerequisites necessary for building Mozilla. This includes the MSYS build environment, <a href="/en-US/docs/Mercurial" title="Mercurial">Mercurial</a>, autoconf-2.13, CVS, Python, YASM, NSIS, and UPX, as well as optional but useful tools such as wget and emacs.</p>

<p><a href="http://ftp.mozilla.org/pub/mozilla.org/mozilla/libraries/win32/MozillaBuildSetup-Latest.exe" title="http://ftp.mozilla.org/pub/mozilla.org/mozilla/libraries/win32/MozillaBuildSetup-Latest.exe">Download the current MozillaBuild package.</a></p>

<p>By default, the package installs to <code>c:\mozilla-build</code>. It is recommended to use the default path. Don't use a path that contains spaces. The installer does not modify the Windows registry. Note that some binaries may require <a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=a5c84275-3b97-4ab7-a40d-3802b2af5fc2&amp;displaylang=en" title="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=a5c84275-3b97-4ab7-a40d-3802b2af5fc2&amp;displaylang=en">Visual C++ Redistributable package</a> to run.</p>

<p><strong>Expectation setting:</strong> Note that the "UNIX-like" environment provided by MozillaBuild is only really useful for building and committing to the Mozilla source. Most command line tools you would expect in a modern Linux distribution are not present, and those tools that are provided can be as much as a decade or so old (especially those provided by MSYS). It's the old tools in particular that can cause problems, since they often don't behave as expected, are buggy, or don't support command line arguments that have been taken for granted for years. For example, copying a source tree using <code>cp -rf src1 src2</code> does not work correctly because of an old version of cp (it gives "cp: will not create hard link" errors for some files). In short, MozillaBuild supports essential developer interactions with the Mozilla code, but beyond that don't be surprised if it trips you up in all sorts of exciting and unexpected ways.</p>

<p>The MozillaBuild package includes the "make" program that originated on the UNIX and Linux platforms. This version of make does not make use of Windows' multi-core architecture. <a href="/en-US/docs/pymake" title="pymake">pymake</a> is a Python implementation of Make that uses Windows' multi-core architecture and thus significantly speeds up build time.</p>

<p><em><a href="/en-US/docs/Developer_Guide/Build_Instructions" title="Build_Documentation">Return to the Build Documentation </a></em></p>
