<div>{{APIRef("HTML DOM")}}</div>

<p>{{ gecko_minversion_header("1.9") }}  在进行拖放操作时，<code>DataTransfer</code> 对象用来保存，通过拖放动作，拖动到浏览器的数据。它可以保存一项或多项数据、一种或者多种数据类型。关于拖放的更多信息，请参见 <a class="internal" href="/En/DragDrop/Drag_and_Drop" title="En/DragDrop/Drag and Drop">Drag and Drop</a>.</p>

<p>这个对象可以从所有拖动事件 {{domxref("DragEvent","drag events")}}<code> </code>的 {{domxref("DragEvent.dataTransfer","dataTransfer")}}<code> </code>属性上获取，但是不能单独创建。</p>

<h2 id="Properties" name="Properties">属性概述</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">属性（Properties）</td>
   <td class="header">类型（Type）</td>
  </tr>
  <tr>
   <td><code><a href="#dropEffect.28.29" title="En/DragDrop/DataTransfer#dropEffect">dropEffect</a></code></td>
   <td><code><a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String" title="en/String">String</a></code></td>
  </tr>
  <tr>
   <td><code><a href="#effectAllowed.28.29" title="En/DragDrop/DataTransfer#effectAllowed">effectAllowed</a></code></td>
   <td><code><a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String" title="en/String">String</a></code></td>
  </tr>
  <tr>
   <td><a href="#files.28.29" title="En/DragDrop/DataTransfer#files"><code>files</code></a> {{ gecko_minversion_inline("1.9.2") }}</td>
   <td>{{ domxref("FileList") }}</td>
  </tr>
  <tr>
   <td><code><a href="#mozCursor" title="En/DragDrop/DataTransfer#mozCursor">mozCursor</a></code> {{ non-standard_inline() }} {{ gecko_minversion_inline("1.9.1") }}</td>
   <td><code><a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String" title="en/String">String</a></code></td>
  </tr>
  <tr>
   <td><code><a href="#mozItemCount.28.29" title="En/DragDrop/DataTransfer#mozItemCount">mozItemCount</a></code> {{ non-standard_inline() }}</td>
   <td><code>unsigned long</code></td>
  </tr>
  <tr>
   <td><a href="#mozSourceNode" title="En/DragDrop/DataTransfer#mozSourceNode"><code>mozSourceNode</code></a> {{ non-standard_inline() }} {{ gecko_minversion_inline("2") }}</td>
   <td>{{ domxref("Node") }}</td>
  </tr>
  <tr>
   <td><a href="#mozUserCancelled" title="En/DragDrop/DataTransfer#mozUserCancelled"><code>mozUserCancelled</code></a></td>
   <td><a href="/en/JavaScript/Reference/Global_Objects/Boolean" title="en/Core JavaScript 1.5 Reference/Global Objects/Boolean"><code>Boolean</code></a></td>
  </tr>
  <tr>
   <td><code><a href="#types.28.29" title="En/DragDrop/DataTransfer#types">types</a></code></td>
   <td><code><a href="/en-US/docs/Web/API/DOMStringList" title="en-US/docs/Web/API/DOMStringList">DOMStringList</a></code></td>
  </tr>
 </tbody>
</table>

<h2 id="Method_overview" name="Method_overview">方法概述</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td><code>void <a href="#addElement.28.29">addElement</a>(in <a href="/en/XPCOM_Interface_Reference/nsIDOMElement" title="en/nsIDOMElement">Element</a> element)</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#clearData.28.29">clearData</a>([in <a href="/en/String" title="en/String">String</a> type])</code></td>
  </tr>
  <tr>
   <td><code><a href="/en/String" title="en/String">String</a> <a href="#getData.28.29">getData</a>(in <a href="/en/String" title="en/String">String</a> type)</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#setData.28.29">setData</a>(in <a href="/en/String" title="en/String">String</a> type, in <a href="/en/String" title="en/String">String</a> data)</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#setDragImage.28.29">setDragImage</a>(in <a href="/en/XPCOM_Interface_Reference/nsIDOMElement" title="en/nsIDOMElement">nsIDOMElement</a> image, in long x, in long y)</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#mozClearDataAt.28.29">mozClearDataAt</a>([in <a href="/en/String" title="en/String">String</a> type, in unsigned long index])</code></td>
  </tr>
  <tr>
   <td><code><a href="/en/XPCOM_Interface_Reference/NsIVariant" title="en/nsIVariant">nsIVariant</a> <a href="#mozGetDataAt.28.29">mozGetDataAt</a>(in <a href="/en/String" title="en/String">String</a> type, in unsigned long index)</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#mozSetDataAt.28.29">mozSetDataAt</a>(in <a href="/en/String" title="en/String">String</a> type, in <a href="/en/XPCOM_Interface_Reference/NsIVariant" title="en/nsIVariant">nsIVariant</a> data, in unsigned long index)</code></td>
  </tr>
  <tr>
   <td><code><a href="/en/StringList" title="en/StringList">StringList</a> <a href="#mozTypesAt.28.29">mozTypesAt</a>([in unsigned long index])</code></td>
  </tr>
 </tbody>
</table>

<h2 id="Properties" name="Properties">属性</h2>

<h3 id="dropEffect.28.29" name="dropEffect.28.29">dropEffect</h3>

<p>获取 / 设置实际的放置效果，它应该始终设置成 <code>effectAllowed</code>  的可能值之一 。</p>

<p>对于 dragenter 和 dragover 事件，dropEffect 将基于用户要求的动作被初始化设置。这如何确定是平台特定的但用户通常可以修改键值来调整为理想动作。在 dragenter 和 dragover 事件的事件处理程序中，如果这个效果不是用户要求的动作，那就应该修改dropEffect 的值。</p>

<p>对于 dragstart, drag和dragleave事件，dropEffect会被初始化为 “none”。任何有效的值都可以用来设置 dropEffect，这是这些设置的值不会做任何事情[译者注：也就是说任何有效值都不会报错，但是在这些事件中设置没有任何效果]。</p>

<p>对于drop和dragend事件，dropEffect将被初始化成期望的动作，这个动作的值是最近的执行dragenter或者dragover事件后的dropEffect的值。</p>

<p>可能的值:</p>

<ul>
 <li><strong>copy</strong>: 复制到新的位置</li>
 <li><strong>move</strong>: 移动到新的位置.</li>
 <li><strong>link</strong>: 建立一个源位置到新位置的链接.</li>
 <li><strong>none</strong>: 禁止放置（禁止任何操作）.</li>
</ul>

<p>分配任何其他值时不会有任何影响并且保留旧值</p>

<h3 id="effectAllowed.28.29" name="effectAllowed.28.29">effectAllowed</h3>

<p>用来指定拖动时被允许的效果。你可以在dragstart事件中设置拖动源数据时期望的动作效果，同时在dragenter和dragover事件中为目标设置期望的效果[译者注：effectAllowed设置允许的效果，在dragenter和dragover中通过设置上面的那个属性dropEffect来确定具体的动作效果]。这些值在其他的事件中没有任何作用。</p>

<p>可能的值:</p>

<ul>
 <li><strong>copy</strong>: 复制到新的位置.</li>
 <li><strong>move</strong>:移动到新的位置 .</li>
 <li><strong>link</strong>:建立一个源位置到新位置的链接.</li>
 <li><strong>copyLink</strong>: 允许复制或者链接.</li>
 <li><strong>copyMove</strong>: 允许复制或者移动.</li>
 <li><strong>linkMove</strong>: 允许链接或者移动.</li>
 <li><strong>all</strong>: 允许所有的操作.</li>
 <li><strong>none</strong>: 禁止所有操作.</li>
 <li><strong>uninitialized</strong>: 缺省值（默认值）, 相当于 all.</li>
</ul>

<p>分配任何其他值时不会有任何影响并且保留旧值</p>

<h3 id="files.28.29" name="files.28.29">files</h3>

<p>{{ gecko_minversion_header("1.9.2") }}</p>

<p>包含一个在数据传输上所有可用的本地文件列表。如果拖动操作不涉及拖动文件，此属性是一个空列表。此属性访问指定的{{ domxref("FileList") }} 中无效的索引将返回未定义（<code>undefined</code>）。</p>

<h4 id="实例">实例</h4>

<p>此实例转存被拖动到浏览器窗口中的文件列表。</p>

<p>找不到文件： <em>filednd.html </em></p>

<p>请到这个页面中查看效果:  <a class="external" href="http://jsfiddle.net/9C2EF/" title="http://jsfiddle.net/9C2EF/">http://jsfiddle.net/9C2EF/</a></p>

<h3 id="types.28.29" name="types.28.29">types</h3>

<p>保存一个被存储数据的类型列表作为第一项，顺序与被添加数据的顺序一致。如果没有添加数据将返回一个空列表。</p>

<p>{{ gecko_minversion_note("1.9.2", 'The string "Files" is included in this list if files are included in the drag.') }}</p>

<p>{{ h3_gecko_minversion("mozCursor", "1.9.1", "mozCursor") }}</p>

<p>拖动光标状态。这主要用来控制光标在拖动过程中的显示。</p>

<div class="note"><strong>Note:</strong> 这个方法目前只能在Windows上实现</div>

<h4 id="可能的值">可能的值</h4>

<dl>
 <dt><code>auto</code></dt>
 <dd>使用系统默认行为。</dd>
 <dt><code>default</code></dt>
 <dd>使用默认的Gecko 行为，是要在拖动操作期间将光标设置为一个箭头。</dd>
</dl>

<div class="note"><strong>Note:</strong> 如果您指定"默认"之外的任何值，则假定"auto"。</div>

<h3 id="mozItemCount.28.29" name="mozItemCount.28.29">mozItemCount</h3>

<p>正被拖动的项的数目。</p>

<div class="note"><strong>Note:</strong> 这个属性是Gecko指定的。</div>

<h3 id="mozSourceNode">mozSourceNode</h3>

<p>{{ gecko_minversion_header("2") }}</p>

<p>The {{ domxref("Node") }} over which the mouse cursor was located when the button was pressed to initiate the drag operation. This value is <code>null</code> for external drags or if the caller can't access the node.</p>

<div class="note"><strong>Note:</strong> 这个属性是Gecko指定的。</div>

<h3 id="mozItemCount.28.29" name="mozItemCount.28.29">mozUserCancelled</h3>

<p>This property applies only to the <code>dragend</code> event, and is <code>true</code> if the user canceled the drag operation by pressing escape. It will be <code>false</code> in all other cases, including if the drag failed for any other reason, for instance due to a drop over an invalid location. This property is not currently implemented on Linux.</p>

<div class="note"><strong>Note:</strong> 这个属性是Gecko指定的。</div>

<h2 id="Methods" name="Methods">方法</h2>

<h3 id="addElement.28.29" name="addElement.28.29">addElement()</h3>

<p>设置拖动源。通常你不需要改变这项，如果修改这项将会影响拖动的哪个节点和dragend事件的触发。默认目标是被拖动的节点。</p>

<pre class="eval"> obj.addElement();
</pre>

<h6 id="Parameters_addElement" name="Parameters_addElement">参数</h6>

<dl>
 <dt><code>element </code></dt>
 <dd>要添加的元素.</dd>
</dl>

<h3 id="clearData.28.29" name="clearData.28.29">clearData()</h3>

<p>删除与给定类型关联的数据。类型参数是可选的。如果类型为空或未指定，将删除所有类型相关联的数据。如果不存在指定类型的数据，或数据传输不包含任何数据，此方法将没有任何效果。</p>

<pre class="eval"> obj.clearData(type);
</pre>

<h6 id="Parameters_clearData" name="Parameters_clearData">参数</h6>

<dl>
 <dt><code>type </code></dt>
 <dd>要删除的数据类型.</dd>
</dl>

<h3 id="getData.28.29" name="getData.28.29">getData()</h3>

<p>根据指定的类型检索数据，如果指定类型的数据不存在或者该 <code>DataTransfer</code> 对象中没有数据，方法将返回一个空字符串。</p>

<pre class="eval"> obj.getData(type);
</pre>

<h6 id="Parameters_addElement" name="Parameters_addElement">参数</h6>

<dl>
 <dt><code>type </code></dt>
 <dd>要检索的数据类型。.</dd>
</dl>

<h3 id="setData.28.29" name="setData.28.29">setData()</h3>

<p>为一个给定的类型设置数据。如果该数据类型不存在，它将添加到的末尾，这样类型列表中的最后一个项目将是新的格式。如果已经存在的数据类型，替换相同的位置的现有数据。就是，当更换相同类型的数据时，不会更改类型列表的顺序。</p>

<pre class="eval"> obj.setData(type,data);
</pre>

<h6 id="Parameters_setData" name="Parameters_setData">参数</h6>

<dl>
 <dt><code>type </code></dt>
 <dd>要添加的数据类型.</dd>
 <dt><code>data </code></dt>
 <dd>要添加的数据.</dd>
</dl>

<h3 id="setDragImage.28.29" name="setDragImage.28.29">setDragImage()</h3>

<p>自定义一个期望的拖动时的图片。大多数情况下，这项不用设置，因为被拖动的节点被创建成默认图片。</p>

<p>如果该节点是 HTML img 元素、 HTML 画布元素或一个 XUL 图像元素，则会使用图像数据[译者注：拖动时的效果将使用这里的图片]。否则为图像应该是可见的节点，根据这个可见的节点创建拖动图像。如果image是null，任何自定义拖动图像都会被清除，并且使用默认值代替。</p>

<p>坐标指定图像相对于鼠标光标位置的偏移量。例如，为使鼠标在图像中心，可以使用图像宽度和高度的值的一半。</p>

<pre class="eval"> obj.setDragImage(imgElement,offsetX,offsetY);
</pre>

<h6 id="Parameters_setDragImage" name="Parameters_setDragImage">参数</h6>

<dl>
 <dt><code>image </code></dt>
 <dd>要用作拖动反馈图像元素</dd>
 <dt><code>x </code></dt>
 <dd>图像内的水平偏移量.</dd>
 <dt><code>y </code></dt>
 <dd>图像内的垂直偏移量.</dd>
</dl>

<h3 id="mozClearDataAt.28.29" name="mozClearDataAt.28.29">mozClearDataAt()</h3>

<p>删除指定索引处与给定格式相关的数据项。索引值应该是在：0 到总项数减 1[译者注：注意索引是从0开始的，所以最后一项应该是: 总项数-1]。</p>

<p>如果数据项的最后一种格式类型被删除，整个数据项都会被删除，同时从 <code>mozItemCount</code>  减 1。</p>

<p>如果各事列表是空的，所有类型相关的数据都会被删除。如果格式没有发现，这个方法没有任何影响。</p>

<div class="note"><strong>Note:</strong> 这个方法是Gecko指定的</div>

<pre class="eval"> void mozClearDataAt(
   [optional] in String type,
   in unsigned long index
 );
</pre>

<h6 id="Parameters_setDragImage" name="Parameters_setDragImage">参数</h6>

<dl>
 <dt><code>type </code></dt>
 <dd>要删除数据的数据类型.</dd>
 <dt><code>index </code></dt>
 <dd>要删除的数据的索引.</dd>
</dl>

<h3 id="mozGetDataAt.28.29" name="mozGetDataAt.28.29">mozGetDataAt()</h3>

<p>取得指定索引处的与给定的格式相关联的数据项，如果不存在返回null。索引值应该是在：0 到总项数减1 [译者注：注意索引是从0开始的，所以最后一项应该是: 总项数-1]。</p>

<div class="note"><strong>Note:</strong> 这个方法是Gecko指定的</div>

<pre class="eval"> nsIVariant mozGetDataAt(
   [optional] in String type,
   in unsigned long index
 );
</pre>

<h6 id="Parameters_setDragImage" name="Parameters_setDragImage">参数</h6>

<dl>
 <dt><code>type </code></dt>
 <dd>要检索的数据类型.</dd>
 <dt><code>index </code></dt>
 <dd>要检索的数据的索引.</dd>
</dl>

<h3 id="mozSetDataAt.28.29" name="mozSetDataAt.28.29">mozSetDataAt()</h3>

<p>一个数据转存(data transfer)可能存储 多条/多项 数据，每一项都从索引0开始。<code>mozSetDataAt()</code> 只可以被索引参数小于<code>mozItemCount</code> 的现有存在项调用，在这种情况下，已存在的项会被修改；或者索引参数等于<code>mozItemCount</code> ，这种情况下，添加一条新项，同时<code>mozItemCount</code> 加一。      </p>

<p>应按优先顺序排列添加数据, 最先添加指定格式最多的数据，最后添加指定格式最少的数据。如果给定格式的数据已经存在，将会替换相同位置上的旧数据。</p>

<p>数据应该是任何一个字符串，布尔值或者数字类型（这将被转换成一个字符串）或者一个 {{ interface("nsISupports") }}。</p>

<div class="note"><strong>Note:</strong> 这个方法是Gecko指定的</div>

<pre class="eval"> void mozSetDataAt(
   [optional] in String type,
   in nsIVariant data,
   in unsigned long index
 );
</pre>

<h6 id="Parameters_setDragImage" name="Parameters_setDragImage">参数</h6>

<dl>
 <dt><code>type </code></dt>
 <dd>要添加的数据类型.</dd>
 <dt><code>data </code></dt>
 <dd>要添加的数据.</dd>
 <dt><code>index </code></dt>
 <dd>要添加的数据的索引.</dd>
</dl>

<h3 id="mozTypesAt.28.29" name="mozTypesAt.28.29">mozTypesAt()</h3>

<p>保存一个指定索引处被存储的数据格式类型的列表。如果索引不是在范围： 0 到总项数减1 [译者注：注意索引是从0开始的，所以最后一项应该是: 总项数-1]，则返回空字符串列表。</p>

<div class="note"><strong>Note:</strong> 这个方法是Gecko指定的</div>

<pre class="eval"> nsIVariant mozTypesAt(
   in unsigned long index
 );
</pre>

<h6 id="Parameters_setDragImage" name="Parameters_setDragImage">参数</h6>

<dl>
 <dt><code>index </code></dt>
 <dd>要取得数据类型的相应的数据索引</dd>
</dl>

<h2 id="See_also" name="See_also">请参见</h2>

<ul>
 <li><a class="internal" href="/zh-CN/docs/Web/API/HTML_Drag_and_Drop_API">拖与放</a></li>
 <li><a href="HTML_Drag_and_Drop_API/Drag_operations">拖动操作</a></li>
 <li><a href="HTML_Drag_and_Drop_API/Recommended_drag_types">推荐拖动类型</a></li>
 <li><a href="/en-US/docs/Web/API/HTML_Drag_and_Drop_API/Multiple_items">拖动多项</a></li>
 <li><a href="https://codepen.io/tech_query/pen/MqGgap">DataTransfer 测试 - 粘贴、拖放</a></li>
</ul>



<p>{{ languages( { "ja": "Ja/DragDrop/DataTransfer" } ) }}</p>