<div>{{ApiRef("DOM")}}</div>

<p>当一个HTML文档切换到设计模式，文档对象会暴漏<code>execCommand</code> 方法，可以让用户运行命令操作可编辑区域的内容。</p>

<p>大多指令作用于文档的选择（加粗，斜体等等），另外一些则是插入新元素（如添加一个链接）或者作用于一整行（如缩进）。当使用<code>contentEditable</code> 属性时，使用<code>execCommand()</code> 将会作用于当前激活的可编辑区域。</p>

<h2 id="语法">语法</h2>

<pre class="syntaxbox"><em>bool</em> = document.execCommand(<em>aCommandName</em>, <em>aShowDefaultUI</em>, <em>aValueArgument</em>)
</pre>

<h3 id="返回值">返回值</h3>

<p>如果指令不支持或无效会返回{{jsxref('Boolean')}}。</p>

<p><strong>注意：</strong> 只有用户交互的部分也就是在渲染元素使用命令之前不被用来修改浏览器才会返回 true。</p>

<h3 id="参数">参数</h3>

<dl>
 <dt><code>aCommandName</code></dt>
 <dd> {{domxref("DOMString")}} 指明执行指令的名臣。 查看 {{anch("Commands")}} 可找到合理的指令的列表。</dd>
 <dt><code>aShowDefaultUI</code></dt>
 <dd>{{jsxref("Boolean")}} 指示是否应该显示默认用户界面。这个未在Mozilla中实现。</dd>
 <dt><code>aValueArgument</code></dt>
 <dd>这个是指令要求的输入参数（如 <code>insertImage</code>, 也就是插入的图片的fURL ),这是 {{domxref("DOMString")}} 提供的信息。 如果没有需要的参数可指定 <code>null</code> 。</dd>
</dl>

<h3 id="指令">指令</h3>

<dl>
 <dt><code>backColor</code></dt>
 <dd>改变文档的背景颜色。在 <code>styleWithCss</code> 模式中，它会改变包含块的背景颜色。这个指令要求传入 {{cssxref("&lt;color&gt;")}} 字符串作为参数值传入。注意在IE中这个指令用来设置文本背景颜色。</dd>
 <dt><code>bold</code></dt>
 <dd>在选择点或插入点切换打开或关闭加粗。IE使用 {{HTMLElement("strong")}} 标签代替{{HTMLElement("b")}}.</dd>
 <dt><code>contentReadOnly</code></dt>
 <dd>使文档内容只读或者可编辑。此指令要求传入一个布尔值true或者false。（不支持IE浏览器。）</dd>
 <dt><code>copy</code></dt>
 <dd>将当前选定内容复制到剪贴板。不同浏览器使这种行为启用的条件不同，并且随着时间的推移而变化。检查兼容性表，以确定是否可以在您的情况下使用它。</dd>
 <dt><code>createLink</code></dt>
 <dd>只有当你有选区的时候才会从选区创建一个锚点链接。此指令要求一个HURF URI字符串作为参数传入。这个 URI 必须至少包含一个字符，即使是个空格。（IE浏览器将会船舰一个URI值为null的链接。）</dd>
 <dt><code>cut</code></dt>
 <dd>剪切当前选择内容复制到剪切板。 不同浏览器使这种行为启用的条件不同，并且随着时间的推移而变化。检查兼容性表，以确定是否可以在您的情况下使用它。</dd>
 <dt><code>decreaseFontSize</code></dt>
 <dd>在选择点或者插入点添加{{HTMLElement("small")}} 标签。 (IE不支持)</dd>
 <dt><code>delete</code></dt>
 <dd>删除当前选择内容。</dd>
 <dt><code>enableInlineTableEditing</code></dt>
 <dd>启用或禁用表格行和列的插入和删除控件。 (IE不支持。)</dd>
 <dt><code>enableObjectResizing</code></dt>
 <dd>启用或禁用图像和其他可调整对象的调整大小操作。 (IE不支持。)</dd>
 <dt><code>fontName</code></dt>
 <dd>改变选择点和插入点的文字名称。此指令需要传入一个文字名称的字符串（例如<code>"Arial"</code>）作为参数。</dd>
 <dt><code>fontSize</code></dt>
 <dd>改变选择点和插入点的文字大小。此指令需要一个 HTML font size (<code>1</code>-<code>7</code>) 作为参数传入。</dd>
 <dt><code>foreColor</code></dt>
 <dd>修改选择点或插入点的文字颜色。此指令要求一个颜色值作为参数传入。</dd>
 <dt><code>formatBlock</code></dt>
 <dd>在包含当前选择内容的行添加一个 HTML 块元素标签，如果已存在一个包含的块元素则会替换 (在火狐浏览器中， BLOCKQUOTE 是异常代码 - 它将包含任何包含的块元素)。此指令要求一个标签的字符串作为一个参数传入。 几乎所有的块央视标签都可以使用 (例如： "H1", "P", "DL", "BLOCKQUOTE")。 (IE只支持标题标签 H1 - H6, ADDRESS, and PRE，这些标签必须包含在分隔符&lt; &gt;中，就像 "&lt;H1&gt;".)</dd>
 <dt><code>forwardDelete</code></dt>
 <dd>此指令可以在光标位置之前删除字符。它与点击删除键相同。</dd>
 <dt><code>heading</code></dt>
 <dd>在选择点或者插入点增加一个标题标签。需要传入标签名为参数 (比如： "H1", "H6")。 (Internet Explorer 和 Safari不支持)</dd>
 <dt><code>hiliteColor</code></dt>
 <dd>改变选区或者插入点的背景颜色。需要传入一个颜色值作为参数。要发挥作用必须启用。(IE不支持。)</dd>
 <dt><code>increaseFontSize</code></dt>
 <dd>在选区或者插入点增加BIG标签。(IE不支持。)</dd>
 <dt><code>indent</code></dt>
 <dd>缩进包含选区或插入点的行。在火狐中，如果选区包含多个行不同层次的缩进，则选区中最少缩进的行才会被缩进。</dd>
 <dt><code>insertBrOnReturn</code></dt>
 <dd>控制是否用回车键插入一个br标签或是讲当前块元素拆分成两个。(IE不支持。)</dd>
 <dt><code>insertHorizontalRule</code></dt>
 <dd>在插入点插入水平线 (删除选区)。</dd>
 <dt><code>insertHTML</code></dt>
 <dd>在插入点插入HTML(删除选区)。需要传入一个有效的HTML字符串作为参数。(IE不支持。)</dd>
 <dt><code>insertImage</code></dt>
 <dd>在插入点插入一张图片 (删除选区)。 需要传入图片地址作为参数。此地址必须至少包含一个字符，哪怕是一个空格。(IE将会创建一个空值的链接)</dd>
 <dt><code>insertOrderedList</code></dt>
 <dd>为选择或插入点创建一个编号的有序列表。</dd>
 <dt><code>insertUnorderedList</code></dt>
 <dd>为选择或插入点创建一个未显示的无序列表。</dd>
 <dt><code>insertParagraph</code></dt>
 <dd>在选择或当前行周围插入段落。（IE在插入点插入段落，并删除选择区内容。）</dd>
 <dt><code>insertText</code></dt>
 <dd>在插入点插入给定的纯文本（删除选择区内容）。</dd>
 <dt><code>italic</code></dt>
 <dd>为选择或插入点打开/关闭斜体。（IE使用EM标记代替I）。</dd>
 <dt><code>justifyCenter</code></dt>
 <dd>使选区或插入点居中。</dd>
 <dt><code>justifyFull</code></dt>
 <dd>使选区或插入点每行排齐。</dd>
 <dt><code>justifyLeft</code></dt>
 <dd>使选区或插入点左对齐。</dd>
 <dt><code>justifyRight</code></dt>
 <dd>使选区或插入点右对齐。</dd>
 <dt><code>outdent</code></dt>
 <dd>使包含选区或插入点的行伸出排。</dd>
 <dt><code>paste</code></dt>
 <dd>在插入点粘贴剪贴板内容（替换当前选择区内容）。必须在user.js首选文件中启用剪贴板功能。 参见附注[1].</dd>
 <dt><code>redo</code></dt>
 <dd>重做以前的撤消命令。</dd>
 <dt><code>removeFormat</code></dt>
 <dd>从当前选区中移除所有格式。</dd>
 <dt><code>selectAll</code></dt>
 <dd>全选可编辑区域内容。</dd>
 <dt><code>strikeThrough</code></dt>
 <dd>在选择点或插入点切换打开或关闭。</dd>
 <dt><code>subscript</code></dt>
 <dd>在选择点或插入点切换下标打开或关闭。</dd>
 <dt><code>superscript</code></dt>
 <dd>在选择点或插入点切换上标打开或关闭。。</dd>
 <dt><code>underline</code></dt>
 <dd>切换选择或插入点的下划线打开或关闭。</dd>
 <dt><code>undo</code></dt>
 <dd>撤消最后执行的命令。</dd>
 <dt><code>unlink</code></dt>
 <dd>从选定的锚点链接中移除锚点标记。</dd>
 <dt><code>useCSS</code> {{禁止内联}}</dt>
 <dd>切换HTML标记或用于生成标记的CSS。需要布尔值true / false作为参数。注意：此参数在逻辑上是向后的（也就是说用false来使用CSS，用true来使用HTML）。（IE不支持）。这已被弃用；使用styleWithCSS指令代替。</dd>
 <dt><code>styleWithCSS</code></dt>
 <dd>替换 <em>useCSS</em> 指令；参数使用如下：true用来在标记中修改/生成样式属性，false用来生成格式化元素。</dd>
</dl>

<h2 id="Example">Example</h2>

<p>在CodePen中的一个例子<a class="external external-icon" href="http://codepen.io/netsi1964/full/QbLLGW/" rel="noopener">怎么用</a></p>

<h2 id="详细说明">详细说明</h2>

<table class="spectable standard-table">
 <tbody>
  <tr>
   <th scope="col">详细说明</th>
   <th scope="col">状态</th>
   <th scope="col">评论</th>
  </tr>
  <tr>
   <td>{{SpecName('HTML Editing', '#execcommand()', 'execCommand')}}</td>
   <td>{{Spec2('HTML Editing')}}</td>
   <td>初始定义</td>
  </tr>
 </tbody>
</table>

<h2 id="浏览器兼容性">浏览器兼容性</h2>

<p>{{CompatibilityTable}}</p>

<div id="compat-desktop">        
<table class="compat-table">
 <tbody>
  <tr>
   <th>Feature</th>
   <th>Chrome</th>
   <th>Edge</th>
   <th>Firefox (Gecko)</th>
   <th>Internet Explorer</th>
   <th>Opera</th>
   <th>Safari</th>
  </tr>
  <tr>
   <td>Basic support</td>
   <td>{{CompatVersionUnknown}}</td>
   <td>{{CompatVersionUnknown}}</td>
   <td>{{CompatVersionUnknown}}<sup>[1]</sup></td>
   <td>{{CompatUnknown}}</td>
   <td>{{CompatUnknown}}</td>
   <td>{{CompatVersionUnknown}}</td>
  </tr>
  <tr>
   <td><code>insertBrOnReturn</code></td>
   <td>{{CompatNo}}</td>
   <td>{{CompatNo}}</td>
   <td>{{CompatVersionUnknown}}</td>
   <td>{{CompatNo}}</td>
   <td>{{CompatNo}}</td>
   <td>{{CompatNo}}</td>
  </tr>
  <tr>
   <td><code>copy</code>/<code>cut</code></td>
   <td>{{CompatVersionUnknown}}</td>
   <td>{{CompatVersionUnknown}}</td>
   <td>{{CompatGeckoDesktop(41)}}</td>
   <td>9</td>
   <td>29</td>
   <td>10</td>
  </tr>
 </tbody>
</table>
</div>

<div id="compat-mobile">        
<table class="compat-table">
 <tbody>
  <tr>
   <th>Feature</th>
   <th>Android</th>
   <th>Chrome for Android</th>
   <th>Edge</th>
   <th>Firefox Mobile (Gecko)</th>
   <th>IE Mobile</th>
   <th>Opera Mobile</th>
   <th>Safari Mobile</th>
  </tr>
  <tr>
   <td>Basic support</td>
   <td>{{CompatUnknown}}</td>
   <td>{{CompatVersionUnknown}}</td>
   <td>{{CompatVersionUnknown}}</td>
   <td>{{CompatVersionUnknown}}<sup>[1]</sup></td>
   <td>{{CompatUnknown}}</td>
   <td>{{CompatUnknown}}</td>
   <td>{{CompatUnknown}}</td>
  </tr>
  <tr>
   <td><code>insertBrOnReturn</code></td>
   <td>{{CompatNo}}</td>
   <td>{{CompatNo}}</td>
   <td>{{CompatNo}}</td>
   <td>{{CompatVersionUnknown}}</td>
   <td>{{CompatNo}}</td>
   <td>{{CompatNo}}</td>
   <td>{{CompatNo}}</td>
  </tr>
  <tr>
   <td><code>copy</code>/<code>cut</code></td>
   <td>{{CompatNo}}</td>
   <td>{{CompatVersionUnknown}}</td>
   <td>{{CompatVersionUnknown}}</td>
   <td>{{CompatGeckoMobile(41)}}</td>
   <td>{{CompatUnknown}}</td>
   <td>{{CompatUnknown}}</td>
   <td>{{CompatNo}}</td>
  </tr>
 </tbody>
</table>
</div>

<p>[1] 在Firefox 41之前，需要在user.js首选文件中启用剪贴板功能。有关更多信息，请参见Mozilla首选项的简要指南。如果指令不被支持或启用，execCommand 会引发异常而不是返回false。在Firefox 41和以后，在任何能够弹出窗口（半可信脚本）的事件处理程序中，默认情况下启用剪贴板功能。</p>

<h2 id="请参阅">请参阅</h2>

<ul>
 <li>{{domxref("HTMLElement.contentEditable")}}</li>
 <li>{{domxref("document.designMode")}}</li>
 <li><a href="/en-US/docs/Rich-Text_Editing_in_Mozilla">Rich-Text Editing in Mozilla</a></li>
 <li><a href="https://github.com/guardian/scribe/blob/master/BROWSERINCONSISTENCIES.md">Scribe's "Browser Inconsistencies" documentation</a> with bugs related to <code>document.execCommand</code>.{{CompatUnknown}}</li>
</ul>